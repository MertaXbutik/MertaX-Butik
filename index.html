<!doctype html>
<html lang="mk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MertaX Butik</title>

  <style>
    :root{
      --bg:#ffffff;
      --txt:#0b1220;
      --muted:#6b7280;
      --border:#e5e7eb;
      --chip:#f3f4f6;
      --shadow:0 12px 28px rgba(15,23,42,.10);
      --radius:18px;
      --dark:#111827;
      --red:#ef4444;
      --green:#16a34a;
      --zara:#0f172a;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;background:var(--bg);color:var(--txt)}
    a{color:inherit}
    img{max-width:100%}
    button,input,select,textarea{font-family:inherit}

    header{
      position:sticky; top:0; z-index:50;
      background:#fff; border-bottom:1px solid var(--border);
    }
    .head{
      max-width:1200px; margin:0 auto; padding:14px 14px 10px;
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }
    .brand{font-size:24px; font-weight:950; letter-spacing:.6px}
    .headBtns{display:flex; gap:10px; flex-wrap:wrap}
    .btn{
      border:1px solid var(--border);
      background:#fff;
      color:var(--txt);
      padding:11px 16px;
      border-radius:999px;
      font-weight:900;
      cursor:pointer;
      transition:.15s;
      user-select:none;
    }
    .btn:hover{transform:translateY(-1px); box-shadow:var(--shadow)}
    .btn-dark{background:var(--dark); color:#fff; border-color:transparent}
    .btn-red{background:var(--red); color:#fff; border-color:transparent}
    .btn-ghost{background:transparent}
    .wrap{max-width:1200px;margin:0 auto;padding:14px}

    /* Category tabs */
    .tabs{
      display:flex; gap:10px;
      overflow-x:auto; -webkit-overflow-scrolling:touch;
      padding:8px 2px 12px;
    }
    .tabs::-webkit-scrollbar{height:6px}
    .tab{
      flex:0 0 auto;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
      font-weight:950;
      cursor:pointer;
      white-space:nowrap;
    }
    .tab.active{background:var(--dark); color:#fff; border-color:transparent}

    /* Toolbar */
    .toolbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; flex-wrap:wrap;
      padding:6px 0 10px;
    }
    .searchRow{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      flex:1; min-width:260px;
    }
    .inp{
      width:min(620px,100%);
      padding:12px 14px;
      border-radius:999px;
      border:1px solid var(--border);
      outline:none;
      background:#fff;
      color:var(--txt);
    }
    .sel{
      border:1px solid var(--border);
      border-radius:999px;
      padding:11px 14px;
      background:#fff;
      font-weight:900;
      color:var(--txt);
      outline:none;
      min-width:160px;
    }
    .badge{
      border:1px solid var(--border);
      background:#fff;
      border-radius:999px;
      padding:10px 12px;
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }
    .small{font-size:12px;color:var(--muted)}
    .meta{margin:10px 0 10px; font-size:12px; color:var(--muted); line-height:1.5}
    .err{color:#b91c1c;font-weight:900; margin-left:10px}

    /* Grid */
    .grid{display:grid; grid-template-columns:repeat(2,1fr); gap:12px}
    @media(min-width:900px){.grid{grid-template-columns:repeat(4,1fr)}}
    .card{
      background:#fff;
      border:1px solid var(--border);
      border-radius:22px;
      overflow:hidden;
      box-shadow:var(--shadow);
      transition:.15s;
      position:relative;
    }
    .card:hover{transform:translateY(-3px)}
    .imgWrap{position:relative}
    .img{width:100%; aspect-ratio:1/1; object-fit:cover; display:block; background:#eee}
    .tagRow{position:absolute; left:10px; top:10px; display:flex; gap:8px; flex-wrap:wrap}
    .tag{
      font-size:11px; font-weight:950;
      padding:6px 10px; border-radius:999px;
      background:rgba(255,255,255,.90);
      border:1px solid var(--border);
      backdrop-filter: blur(6px);
    }
    .tag-new{background:#dcfce7;border-color:transparent;color:#166534}
    .tag-sale{background:#fee2e2;border-color:transparent;color:#991b1b}

    .p{padding:12px}
    .name{margin:0 0 6px;font-weight:950;font-size:14px}
    .sub{margin:0 0 10px; font-size:12px; color:var(--muted)}
    .priceLine{display:flex; align-items:baseline; gap:8px; flex-wrap:wrap; margin:0 0 10px}
    .priceNow{font-weight:950; font-size:16px}
    .priceOld{color:var(--muted); text-decoration:line-through; font-size:13px}
    .miniRow{display:flex; gap:8px; align-items:center; justify-content:space-between; flex-wrap:wrap}
    .sizeSel{min-width:150px}

    .center{display:flex; justify-content:center; margin:14px 0}

    /* Overlay + drawers */
    .overlay{position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; z-index:90}
    .overlay.show{display:block}

    .drawer, .filterDrawer{
      position:fixed; right:0; top:0; height:100%;
      width:min(430px,92vw);
      background:#fff;
      border-left:1px solid var(--border);
      transform:translateX(110%);
      transition:.22s;
      z-index:95;
      display:flex; flex-direction:column;
    }
    .filterDrawer{z-index:96}
    .drawer.open, .filterDrawer.open{transform:translateX(0)}
    .drawerHead{
      padding:14px; border-bottom:1px solid var(--border);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .drawerHead h2{margin:0;font-size:18px}
    .xbtn{
      width:40px; height:40px; border-radius:999px;
      background:var(--chip); border:1px solid var(--border);
      cursor:pointer; font-size:18px;
    }

    .cartlist{padding:10px 14px; overflow:auto; flex:1}
    .item{display:flex; gap:10px; padding:10px 0; border-bottom:1px solid var(--border)}
    .thumb{width:56px;height:56px;border-radius:14px;object-fit:cover;background:#eee}
    .itxt{flex:1}
    .itxt b{display:block;font-size:13px;margin-bottom:4px}
    .qty{display:flex; gap:6px; align-items:center; flex-wrap:wrap}
    .qty button{width:34px;height:34px;border-radius:999px;border:1px solid var(--border);background:#fff;font-size:18px;cursor:pointer}
    .foot{padding:12px 14px;border-top:1px solid var(--border)}
    .foot .line{display:flex;justify-content:space-between;margin:8px 0}

    /* Filter drawer */
    .section{padding:14px; border-bottom:1px solid var(--border)}
    .secTitle{font-weight:950; margin:0 0 10px}
    .two{display:grid; gap:10px; grid-template-columns:1fr 1fr}
    @media(max-width:520px){.two{grid-template-columns:1fr}}
    .chipRow{display:flex; gap:8px; flex-wrap:wrap}
    .chipBtn{
      border:1px solid var(--border);
      background:var(--chip);
      border-radius:999px;
      padding:8px 12px;
      font-weight:900;
      cursor:pointer;
      font-size:12px;
    }
    .chipBtn.active{background:var(--dark); color:#fff; border-color:transparent}

    /* Modals */
    .modal{
      position:fixed; left:50%; top:50%;
      transform:translate(-50%,-50%);
      width:min(920px,92vw);
      background:#fff; border:1px solid var(--border);
      border-radius:22px; z-index:100;
      display:none; box-shadow:var(--shadow);
    }
    .modal.show{display:block}
    .modalHead{
      padding:14px; border-bottom:1px solid var(--border);
      display:flex; align-items:center; justify-content:space-between; gap:10px
    }
    .modalHead h3{margin:0;font-size:18px}
    .modalBody{padding:14px; max-height:72vh; overflow:auto}
    .ta{width:100%;padding:12px 14px;border-radius:14px;border:1px solid var(--border);background:#fff;outline:none;min-height:80px;resize:vertical}
    .hr{height:1px;background:var(--border);margin:12px 0}
    .pill{font-size:11px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:var(--chip)}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .col{flex:1; min-width:220px}
    .label{font-weight:950; font-size:12px; margin:0 0 6px}
    .help{font-size:12px; color:var(--muted); margin-top:6px}
    .warn{color:#b91c1c; font-weight:900}

    .adminList{display:grid; gap:10px}
    .adminItem{
      border:1px solid var(--border); border-radius:18px;
      padding:10px; display:flex; gap:10px; align-items:center;
    }
    .adminItem img{width:54px;height:54px;border-radius:14px;object-fit:cover;background:#eee}
    .adminItem b{display:block}
    .adminItem .mini{font-size:12px;color:var(--muted)}
  </style>
</head>

<body>
<header>
  <div class="head">
    <div class="brand">MertaX Butik</div>
    <div class="headBtns">
      <button class="btn btn-ghost" id="adminBtn">Admin</button>
      <button class="btn" id="openCartBtn">–ö–æ—à–Ω–∏—á–∫–∞</button>
      <button class="btn btn-red" id="clearCartBtn">–ò—Å–ø—Ä–∞–∑–Ω–∏</button>
    </div>
  </div>
</header>

<div class="wrap">
  <div class="tabs" id="tabs"></div>

  <div class="toolbar">
    <div class="searchRow">
      <input class="inp" id="searchInp" placeholder="Search (–∏–º–µ, –±—Ä–µ–Ω–¥, –±–æ—ò–∞)..." />
      <button class="btn btn-dark" id="openFilterBtn">FILTER</button>

      <select class="sel" id="sortSel">
        <option value="default">–°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–æ</option>
        <option value="price_asc">–¶–µ–Ω–∞ ‚Üë</option>
        <option value="price_desc">–¶–µ–Ω–∞ ‚Üì</option>
        <option value="new_first">–ù–û–í–û –ø—Ä–≤–æ</option>
        <option value="sale_first">–ê–ö–¶–ò–à–ê –ø—Ä–≤–æ</option>
        <option value="name_asc">–ò–º–µ A‚ÜíZ</option>
      </select>
    </div>

    <div class="badge">
      üõí <span>–ö–æ—à–Ω–∏—á–∫–∞:</span> <b id="cartCount">0</b>
      <span class="small">| –í–∫—É–ø–Ω–æ: <b id="cartTotal">0</b> –¥–µ–Ω.</span>
    </div>
  </div>

  <div class="meta">
    WhatsApp: <a href="https://wa.me/38972912601" target="_blank"><b>+38972912601</b></a>
    ‚Ä¢ –õ–æ–∫–∞—Ü–∏—ò–∞: <b>–¢–¶ –ú–∞–≤—Ä–æ–≤–∫–∞</b>
    <span id="errLine" class="err"></span>
    <div id="infoLine" class="small"></div>
  </div>

  <div class="grid" id="productGrid"></div>

  <div class="center">
    <button class="btn btn-ghost" id="loadMoreBtn" style="display:none;">–í—á–∏—Ç–∞—ò —É—à—Ç–µ</button>
  </div>
</div>

<div class="overlay" id="overlay"></div>

<!-- CART drawer -->
<aside class="drawer" id="drawer">
  <div class="drawerHead">
    <h2>–ö–æ—à–Ω–∏—á–∫–∞</h2>
    <button class="xbtn" id="closeCartBtn">‚úï</button>
  </div>
  <div class="cartlist" id="cartList"></div>
  <div class="foot">
    <div class="line"><span>–ü—Ä–æ–∏–∑–≤–æ–¥–∏</span> <b id="sumItems">0 –¥–µ–Ω.</b></div>
    <div class="line"><span>–î–æ—Å—Ç–∞–≤–∞</span> <b id="shipLine">150 –¥–µ–Ω.</b></div>
    <div class="line"><span>–í–∫—É–ø–Ω–æ</span> <b><span id="sumTotal">0</span> –¥–µ–Ω.</b></div>
    <button class="btn btn-dark" id="goCheckoutBtn" style="width:100%;">–ù–∞—Ä–∞—á–∞—ò</button>
    <div class="small" style="margin-top:8px;">–ü–ª–∞—ú–∞—ö–µ: –≥–æ—Ç–æ–≤–æ –ø—Ä–∏ –ø—Ä–∏–µ–º ‚Ä¢ –ú–æ–∂–Ω–æ—Å—Ç –∑–∞ –∑–∞–º–µ–Ω–∞: –¥–∞</div>
  </div>
</aside>

<!-- FILTER drawer -->
<aside class="filterDrawer" id="filterDrawer">
  <div class="drawerHead">
    <h2>–§–∏–ª—Ç–µ—Ä</h2>
    <button class="xbtn" id="closeFilterBtn">‚úï</button>
  </div>

  <div style="overflow:auto; flex:1;">
    <div class="section">
      <div class="secTitle">–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞</div>
      <select class="sel" id="filterCatSel" style="width:100%; min-width:unset"></select>
    </div>

    <div class="section">
      <div class="secTitle">–û–∑–Ω–∞–∫–∞</div>
      <div class="chipRow" id="badgeChips"></div>
    </div>

    <div class="section">
      <div class="secTitle">–ì–æ–ª–µ–º–∏–Ω–∞</div>
      <select class="sel" id="filterSizeSel" style="width:100%; min-width:unset"></select>
      <div class="help">* –ö–∞—ò –§–∞—Ä–º–µ—Ä–∫–∏/–ü–∞–Ω—Ç–∞–ª–æ–Ω–∏ –∏–º–∞ 30‚Äì42.</div>
    </div>

    <div class="section">
      <div class="secTitle">–ë—Ä–µ–Ω–¥ / –ú–∞—Ä–∫–∞</div>
      <input class="inp" id="filterBrandInp" placeholder="–ø—Ä–∏–º–µ—Ä: Zara / Nike..." style="width:100%" />
    </div>

    <div class="section">
      <div class="secTitle">–ë–æ—ò–∞</div>
      <input class="inp" id="filterColorInp" placeholder="–ø—Ä–∏–º–µ—Ä: —Ü—Ä–Ω–∞ / –±–µ–ª–∞..." style="width:100%" />
    </div>

    <div class="section">
      <div class="secTitle">–¶–µ–Ω–∞</div>
      <div class="two">
        <input class="inp" id="minPriceInp" type="number" placeholder="–¶–µ–Ω–∞ –æ–¥" />
        <input class="inp" id="maxPriceInp" type="number" placeholder="–¶–µ–Ω–∞ –¥–æ" />
      </div>
    </div>
  </div>

  <div class="foot">
    <button class="btn btn-dark" id="applyFilterBtn" style="width:100%;">–ü—Ä–∏–º–µ–Ω–∏</button>
    <button class="btn" id="resetFilterBtn" style="width:100%; margin-top:10px;">–†–µ—Å–µ—Ç</button>
  </div>
</aside>

<!-- ADMIN modal -->
<div class="modal" id="adminModal">
  <div class="modalHead">
    <h3>Admin</h3>
    <button class="xbtn" id="closeAdminBtn">‚úï</button>
  </div>
  <div class="modalBody">
    <div class="row">
      <div class="col">
        <div class="label">PIN (—Å—Ç–∞–Ω–¥–∞—Ä–¥–Ω–æ: 1234)</div>
        <input class="inp" id="pinInp" placeholder="–í–Ω–µ—Å–∏ PIN..." />
        <div class="help">–ê–∫–æ —Å–∞–∫–∞—à –¥–∞ —Å–º–µ–Ω–∏—à PIN, —ú–µ –∏–º–∞ –∫–æ–ø—á–µ –¥–æ–ª—É.</div>
      </div>
      <div class="col">
        <button class="btn btn-dark" id="unlockBtn" style="width:100%;">–û—Ç–∫–ª—É—á–∏</button>
        <button class="btn" id="changePinBtn" style="width:100%; margin-top:10px;">–°–º–µ–Ω–∏ PIN</button>
      </div>
    </div>

    <div class="hr"></div>

    <div id="adminLockedNote" class="warn">Admin –µ –∑–∞–∫–ª—É—á–µ–Ω. –í–Ω–µ—Å–∏ PIN.</div>

    <div id="adminArea" style="display:none;">
      <div class="row">
        <div class="col">
          <div class="label">–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞</div>
          <select class="sel" id="pCat" style="width:100%; min-width:unset"></select>
        </div>
        <div class="col">
          <div class="label">–û–∑–Ω–∞–∫–∞</div>
          <select class="sel" id="pBadge" style="width:100%; min-width:unset">
            <option value="">–ë–µ–∑</option>
            <option value="NEW">–ù–û–í–û</option>
            <option value="SALE">–ê–ö–¶–ò–à–ê</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div class="col">
          <div class="label">–ò–º–µ</div>
          <input class="inp" id="pName" placeholder="–ø—Ä–∏–º–µ—Ä: –ë–ª—É–∑–æ–Ω Oversize" />
        </div>
        <div class="col">
          <div class="label">–ë—Ä–µ–Ω–¥/–ú–∞—Ä–∫–∞</div>
          <input class="inp" id="pBrand" placeholder="–ø—Ä–∏–º–µ—Ä: Zara" />
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div class="col">
          <div class="label">–ë–æ—ò–∞</div>
          <input class="inp" id="pColor" placeholder="–ø—Ä–∏–º–µ—Ä: —Ü—Ä–Ω–∞" />
        </div>
        <div class="col">
          <div class="label">–¶–µ–Ω–∞ (–Ω–æ–≤–∞)</div>
          <input class="inp" id="pPrice" type="number" placeholder="–ø—Ä–∏–º–µ—Ä: 1990" />
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div class="col">
          <div class="label">–°—Ç–∞—Ä–∞ —Ü–µ–Ω–∞ (–∞–∫–æ –µ –ø–æ–ø—É—Å—Ç)</div>
          <input class="inp" id="pOldPrice" type="number" placeholder="–ø—Ä–∏–º–µ—Ä: 2490" />
          <div class="help">–ê–∫–æ –≤–Ω–µ—Å–µ—à —Å—Ç–∞—Ä–∞ —Ü–µ–Ω–∞, —ú–µ —Å–µ –ø—Ä–∏–∫–∞–∂–µ –ø—Ä–µ—Ü—Ä—Ç–∞–Ω–∞.</div>
        </div>
        <div class="col">
          <div class="label">–ì–æ–ª–µ–º–∏–Ω–∏</div>
          <select class="sel" id="pSizePreset" style="width:100%; min-width:unset">
            <option value="SML">S/M/L/XL/2XL/3XL</option>
            <option value="JEANS">–§–∞—Ä–º–µ—Ä–∫–∏ 30-42</option>
            <option value="CUSTOM">–†–∞—á–Ω–æ (—Å–æ –∑–∞–ø–∏—Ä–∫–∏)</option>
          </select>
          <input class="inp" id="pSizes" placeholder="–ø—Ä–∏–º–µ—Ä: S,M,L" style="margin-top:10px;" />
        </div>
      </div>

      <div class="hr"></div>

      <div class="row">
        <div class="col">
          <div class="label">–°–ª–∏–∫–∞ –æ–¥ Gallery</div>
          <input class="inp" id="imgGallery" type="file" accept="image/*" />
          <div class="help">–ò–∑–±–µ—Ä–∏ —Å–ª–∏–∫–∞ –æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω.</div>
        </div>
        <div class="col">
          <div class="label">–ö–∞—á–∏ —Å–ª–∏–∫–∞ –æ–¥ –∫–∞–º–µ—Ä–∞</div>
          <input class="inp" id="imgCamera" type="file" accept="image/*" capture="environment" />
          <div class="help">–å–µ –æ—Ç–≤–æ—Ä–∏ –∫–∞–º–µ—Ä–∞.</div>
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div class="col">
          <img id="imgPreview" alt="" style="width:100%; max-height:240px; object-fit:cover; border-radius:18px; border:1px solid var(--border); background:#f3f4f6;">
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <button class="btn btn-dark" id="addProductBtn">–î–æ–¥–∞—ò –ø—Ä–æ–∏–∑–≤–æ–¥</button>
        <button class="btn" id="exportBtn">Export (JSON)</button>
        <button class="btn" id="importBtn">Import (JSON)</button>
      </div>
      <textarea class="ta" id="jsonBox" placeholder="Export/Import JSON —Ç—É–∫–∞..."></textarea>

      <div class="hr"></div>

      <div class="secTitle">–õ–∏—Å—Ç–∞ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏ (–±—Ä–∏—à–µ—ö–µ)</div>
      <div class="row" style="margin-bottom:10px;">
        <select class="sel" id="adminFilterCat" style="min-width:220px"></select>
        <input class="inp" id="adminSearch" placeholder="–ü—Ä–µ–±–∞—Ä–∞—ò (–∏–º–µ/–±—Ä–µ–Ω–¥/–±–æ—ò–∞)..." style="width:min(520px,100%)" />
      </div>
      <div class="adminList" id="adminList"></div>
    </div>
  </div>
</div>

<!-- CHECKOUT modal -->
<div class="modal" id="checkoutModal">
  <div class="modalHead">
    <h3>–ù–∞—Ä–∞—á–∫–∞</h3>
    <button class="xbtn" id="closeCheckoutBtn">‚úï</button>
  </div>
  <div class="modalBody">
    <div class="row">
      <div class="col">
        <div class="label">–ò–º–µ –∏ –ø—Ä–µ–∑–∏–º–µ</div>
        <input class="inp" id="cName" placeholder="–ø—Ä–∏–º–µ—Ä: –ï—Ä–µ–Ω –¢—É–Ω–∞" />
      </div>
      <div class="col">
        <div class="label">–¢–µ–ª–µ—Ñ–æ–Ω</div>
        <input class="inp" id="cPhone" placeholder="–ø—Ä–∏–º–µ—Ä: 07x xxx xxx" />
      </div>
    </div>

    <div class="row" style="margin-top:10px;">
      <div class="col">
        <div class="label">–ê–¥—Ä–µ—Å–∞</div>
        <input class="inp" id="cAddr" placeholder="–ø—Ä–∏–º–µ—Ä: –°–∫–æ–ø—ò–µ..." />
      </div>
    </div>

    <div class="row" style="margin-top:10px;">
      <div class="col">
        <div class="label">–ü–æ—Ä–∞–∫–∞/–ó–∞–±–µ–ª–µ—à–∫–∞</div>
        <textarea class="ta" id="cNote" placeholder="–û–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ..."></textarea>
      </div>
    </div>

    <div class="hr"></div>

    <div class="row">
      <span class="pill">–ü–ª–∞—ú–∞—ö–µ: –≥–æ—Ç–æ–≤–æ –ø—Ä–∏ –ø—Ä–∏–µ–º</span>
      <span class="pill">–î–æ—Å—Ç–∞–≤–∞: +150 –¥–µ–Ω.</span>
      <span class="pill">–ú–æ–∂–Ω–æ—Å—Ç –∑–∞ –∑–∞–º–µ–Ω–∞: –¥–∞</span>
    </div>

    <div class="row" style="margin-top:12px;">
      <label style="display:flex;gap:10px;align-items:center;font-weight:900;">
        <input type="checkbox" id="cExchange" checked />
        –°–∞–∫–∞–º –æ–ø—Ü–∏—ò–∞ –∑–∞ –∑–∞–º–µ–Ω–∞ (–∞–∫–æ —Ç—Ä–µ–±–∞)
      </label>
    </div>

    <div class="hr"></div>

    <div class="secTitle">–ü—Ä–µ–≥–ª–µ–¥</div>
    <div class="small" id="orderPreview"></div>

    <div class="row" style="margin-top:12px;">
      <button class="btn btn-dark" id="sendOrderBtn">–ò—Å–ø—Ä–∞—Ç–∏ –Ω–∞ WhatsApp</button>
    </div>
    <div class="small" style="margin-top:8px;">
      –å–µ —Å–µ –∫—Ä–µ–∏—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç—Å–∫–∏ –±—Ä–æ—ò –Ω–∞ –Ω–∞—Ä–∞—á–∫–∞ –∏ —ú–µ —Å–µ –æ—Ç–≤–æ—Ä–∏ WhatsApp –ø–æ—Ä–∞–∫–∞.
    </div>
  </div>
</div>

<script>
/* =========================
   MertaX Butik - Single file
   ========================= */

const WHATSAPP_NUMBER = "38972912601";
const LOCATION_TEXT = "–¢–¶ –ú–∞–≤—Ä–æ–≤–∫–∞";
const SHIPPING_FEE = 150;
const MAX_PER_CATEGORY = 150;

const CATEGORIES = [
  "–è–µ–º–ø–µ—Ä–∏",
  "–ë–ª—É–∑–æ–Ω–∏",
  "–ú–∞–∏—Ü–∏",
  "–ö–æ—à—É–ª–∏",
  "–§–∞—Ä–º–µ—Ä–∫–∏/–ü–∞–Ω—Ç–∞–ª–æ–Ω–∏",
  "–¢—Ä–µ–Ω–µ—Ä–∫–∏",
  "–à–∞–∫–Ω–∏",
  "–û–¥–µ–ª–∞"
];

const SIZE_PRESET_SML = ["S","M","L","XL","2XL","3XL"];
const SIZE_PRESET_JEANS = Array.from({length:13}, (_,i)=> String(30+i)); // 30..42

// --- DOM ---
const tabsEl = document.getElementById("tabs");
const gridEl = document.getElementById("productGrid");
const infoLine = document.getElementById("infoLine");
const errLine = document.getElementById("errLine");

const searchInp = document.getElementById("searchInp");
const sortSel = document.getElementById("sortSel");
const loadMoreBtn = document.getElementById("loadMoreBtn");

const overlay = document.getElementById("overlay");
const drawer = document.getElementById("drawer");
const cartList = document.getElementById("cartList");
const cartCount = document.getElementById("cartCount");
const cartTotal = document.getElementById("cartTotal");
const sumItems = document.getElementById("sumItems");
const shipLine = document.getElementById("shipLine");
const sumTotal = document.getElementById("sumTotal");

const openCartBtn = document.getElementById("openCartBtn");
const closeCartBtn = document.getElementById("closeCartBtn");
const clearCartBtn = document.getElementById("clearCartBtn");
const goCheckoutBtn = document.getElementById("goCheckoutBtn");

const filterDrawer = document.getElementById("filterDrawer");
const openFilterBtn = document.getElementById("openFilterBtn");
const closeFilterBtn = document.getElementById("closeFilterBtn");
const filterCatSel = document.getElementById("filterCatSel");
const badgeChips = document.getElementById("badgeChips");
const filterSizeSel = document.getElementById("filterSizeSel");
const filterBrandInp = document.getElementById("filterBrandInp");
const filterColorInp = document.getElementById("filterColorInp");
const minPriceInp = document.getElementById("minPriceInp");
const maxPriceInp = document.getElementById("maxPriceInp");
const applyFilterBtn = document.getElementById("applyFilterBtn");
const resetFilterBtn = document.getElementById("resetFilterBtn");

// Admin
const adminBtn = document.getElementById("adminBtn");
const adminModal = document.getElementById("adminModal");
const closeAdminBtn = document.getElementById("closeAdminBtn");
const pinInp = document.getElementById("pinInp");
const unlockBtn = document.getElementById("unlockBtn");
const changePinBtn = document.getElementById("changePinBtn");
const adminLockedNote = document.getElementById("adminLockedNote");
const adminArea = document.getElementById("adminArea");

const pCat = document.getElementById("pCat");
const pBadge = document.getElementById("pBadge");
const pName = document.getElementById("pName");
const pBrand = document.getElementById("pBrand");
const pColor = document.getElementById("pColor");
const pPrice = document.getElementById("pPrice");
const pOldPrice = document.getElementById("pOldPrice");
const pSizePreset = document.getElementById("pSizePreset");
const pSizes = document.getElementById("pSizes");
const imgGallery = document.getElementById("imgGallery");
const imgCamera = document.getElementById("imgCamera");
const imgPreview = document.getElementById("imgPreview");
const addProductBtn = document.getElementById("addProductBtn");

const exportBtn = document.getElementById("exportBtn");
const importBtn = document.getElementById("importBtn");
const jsonBox = document.getElementById("jsonBox");

const adminFilterCat = document.getElementById("adminFilterCat");
const adminSearch = document.getElementById("adminSearch");
const adminList = document.getElementById("adminList");

// Checkout
const checkoutModal = document.getElementById("checkoutModal");
const closeCheckoutBtn = document.getElementById("closeCheckoutBtn");
const cName = document.getElementById("cName");
const cPhone = document.getElementById("cPhone");
const cAddr = document.getElementById("cAddr");
const cNote = document.getElementById("cNote");
const cExchange = document.getElementById("cExchange");
const orderPreview = document.getElementById("orderPreview");
const sendOrderBtn = document.getElementById("sendOrderBtn");

// --- State ---
let activeCat = CATEGORIES[0];
let visibleLimit = 30; // load more increments
let filterState = {
  cat: activeCat,
  badge: "ALL", // ALL | NEW | SALE | NONE
  size: "ALL",
  brand: "",
  color: "",
  minPrice: null,
  maxPrice: null
};

let selectedBadgeChip = "ALL";

// --- Storage keys ---
const K_PRODUCTS = "mertax_products_v1";
const K_CART = "mertax_cart_v1";
const K_PIN = "mertax_admin_pin_v1";

// --- Helpers ---
function $(id){ return document.getElementById(id); }
function safeJsonParse(str, fallback){
  try{ return JSON.parse(str); }catch{ return fallback; }
}
function numOrNull(v){
  if(v === "" || v === null || v === undefined) return null;
  const n = Number(v);
  return Number.isFinite(n) ? n : null;
}
function escapeHtml(s){
  return String(s||"")
    .replaceAll("&","&amp;").replaceAll("<","&lt;")
    .replaceAll(">","&gt;").replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}
function uid(){
  return "p_" + Math.random().toString(16).slice(2) + "_" + Date.now().toString(16);
}
function nowId(){
  // order number: MTX-YYYYMMDD-HHMMSS-XXXX
  const d = new Date();
  const pad = (x)=> String(x).padStart(2,"0");
  const y = d.getFullYear();
  const m = pad(d.getMonth()+1);
  const da = pad(d.getDate());
  const h = pad(d.getHours());
  const mi = pad(d.getMinutes());
  const s = pad(d.getSeconds());
  const rnd = Math.random().toString(16).slice(2,6).toUpperCase();
  return `MTX-${y}${m}${da}-${h}${mi}${s}-${rnd}`;
}
function isJeansCat(cat){ return cat === "–§–∞—Ä–º–µ—Ä–∫–∏/–ü–∞–Ω—Ç–∞–ª–æ–Ω–∏"; }
function defaultSizesForCat(cat){
  return isJeansCat(cat) ? SIZE_PRESET_JEANS : SIZE_PRESET_SML;
}
function formatDen(n){
  const x = Number(n)||0;
  return String(x);
}
function makePlaceholderSVG(title){
  const t = encodeURIComponent(title);
  return `data:image/svg+xml;charset=utf-8,` +
    `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='800'>`+
    `<rect width='100%25' height='100%25' fill='%23f3f4f6'/>`+
    `<text x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='40' fill='%239ca3af'>${t}</text>`+
    `</svg>`;
}

// --- Products ---
function getProducts(){
  const p = safeJsonParse(localStorage.getItem(K_PRODUCTS), null);
  if(Array.isArray(p)) return p;
  const seed = seedProducts();
  localStorage.setItem(K_PRODUCTS, JSON.stringify(seed));
  return seed;
}
function setProducts(list){
  localStorage.setItem(K_PRODUCTS, JSON.stringify(list));
}
function seedProducts(){
  // —Å–∞–º–æ –Ω–µ–∫–æ–ª–∫—É –ø—Ä–∏–º–µ—Ä ‚Äî —Ç–∏ –¥–æ–¥–∞–¥–µ—à –æ–¥ Admin
  return [
    {
      id: uid(),
      cat: "–è–µ–º–ø–µ—Ä–∏",
      name: "–è–µ–º–ø–µ—Ä

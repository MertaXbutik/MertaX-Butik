<!doctype html>
<html lang="mk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MertaX Butik</title>
  <style>
    :root{
      --bg:#0b0b0b;
      --card:#121212;
      --card2:#161616;
      --line:rgba(255,255,255,.10);
      --txt:#fff;
      --muted:rgba(255,255,255,.70);
      --muted2:rgba(255,255,255,.55);
      --accent:#22c55e;
      --accent2:#16a34a;
      --danger:#ef4444;
      --warn:#f59e0b;
      --shadow:0 12px 30px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background: radial-gradient(1200px 600px at 20% 0%, rgba(34,197,94,.22), transparent 60%),
                  radial-gradient(900px 500px at 90% 10%, rgba(59,130,246,.18), transparent 60%),
                  #060606;
      color:var(--txt);
    }
    a{color:inherit}
    .top{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(10px);
      background: rgba(0,0,0,.55);
      border-bottom:1px solid var(--line);
    }
    .top-inner{
      max-width:1100px; margin:0 auto;
      padding:14px 14px 12px;
      display:flex; gap:14px; align-items:center; justify-content:space-between;
    }
    .brand{display:flex; gap:12px; align-items:center;}
    .logo{
      width:48px;height:48px;border-radius:14px;
      background: linear-gradient(135deg, rgba(34,197,94,.9), rgba(59,130,246,.75));
      display:grid; place-items:center;
      box-shadow: var(--shadow);
      flex:0 0 auto;
    }
    .logo svg{filter: drop-shadow(0 6px 10px rgba(0,0,0,.35))}
    .btxt{line-height:1.05}
    .btxt b{display:block; font-size:22px; letter-spacing:.6px}
    .btxt small{display:block; color:var(--muted); font-size:12.5px; margin-top:4px}
    .right-actions{display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end}
    .chip{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding:8px 10px;
      border-radius:999px;
      color:var(--muted);
      font-size:12.5px;
      max-width:60vw;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .btn{
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:650;
      transition:.15s transform,.15s background,.15s border;
      display:inline-flex; align-items:center; gap:8px;
    }
    .btn:hover{transform: translateY(-1px); background: rgba(255,255,255,.09)}
    .btn:active{transform: translateY(0)}
    .btn.primary{background: rgba(34,197,94,.18); border-color: rgba(34,197,94,.40)}
    .btn.primary:hover{background: rgba(34,197,94,.25)}
    .btn.danger{background: rgba(239,68,68,.15); border-color: rgba(239,68,68,.35)}
    .btn.ghost{background: transparent}
    .container{
      max-width:1100px; margin:0 auto; padding:16px 14px 40px;
    }

    .panel{
      border:1px solid var(--line);
      background: rgba(10,10,10,.55);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .products-head{
      padding:14px 14px 12px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .title{font-size:22px; font-weight:900; letter-spacing:.4px}
    .muted{color:var(--muted)}
    .muted2{color:var(--muted2)}
    .howto{
      margin-top:8px;
      font-size:13px;
      color:var(--muted);
      line-height:1.35;
    }
    .filters{
      padding:12px 14px;
      display:flex; gap:10px; flex-wrap:wrap;
      border-bottom:1px solid var(--line);
      align-items:center;
    }
    .input, .select{
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color:var(--txt);
      padding:11px 12px;
      border-radius:14px;
      outline:none;
      min-width:210px;
    }
    .select{min-width:230px}
    .small{font-size:12.5px}
    .cards{
      padding:14px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
    }
    @media (max-width: 980px){ .cards{grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 560px){ .cards{grid-template-columns: 1fr;} }

    .card{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 18px;
      overflow:hidden;
      box-shadow: 0 8px 24px rgba(0,0,0,.28);
      display:flex; flex-direction:column;
      min-height: 360px;
    }
    .imgwrap{
      position:relative;
      aspect-ratio: 16/10;
      background: rgba(255,255,255,.03);
      overflow:hidden;
    }
    .imgwrap img{
      width:100%; height:100%;
      object-fit:cover;
      display:block;
    }
    .badge{
      position:absolute; top:10px; left:10px;
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:800;
      border:1px solid var(--line);
      background: rgba(0,0,0,.45);
      backdrop-filter: blur(6px);
    }
    .cardbody{padding:12px 12px 12px; display:flex; flex-direction:column; gap:10px; flex:1}
    .pname{font-size:18px; font-weight:900; letter-spacing:.2px; line-height:1.15}
    .price{font-size:18px; font-weight:900}
    .meta{display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; color:var(--muted)}
    .sizes{
      display:flex; gap:8px; flex-wrap:wrap;
    }
    .sz{
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      padding:6px 8px;
      border-radius:999px;
      font-size:12.5px;
      display:inline-flex; align-items:center; gap:7px;
      color:var(--muted);
    }
    .dot{width:10px;height:10px;border-radius:50%}
    .dot.g{background: var(--accent)}
    .dot.r{background: var(--danger)}
    .actions{
      margin-top:auto;
      display:flex; gap:10px;
    }
    .actions .btn{flex:1; justify-content:center}

    .footerbar{
      margin-top:10px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:space-between;
      padding:12px 14px 14px;
      color:var(--muted2);
    }

    /* MODALS */
    .modal{
      position:fixed; inset:0;
      background: rgba(0,0,0,.62);
      display:none;
      z-index:999;
      padding:14px;
      overflow:auto;
    }
    .modal.open{display:block}
    .modal-card{
      max-width:640px; margin:40px auto;
      border:1px solid var(--line);
      background: rgba(12,12,12,.92);
      border-radius: 18px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modal-head{
      padding:14px 14px 12px;
      border-bottom:1px solid var(--line);
      display:flex; justify-content:space-between; align-items:center; gap:10px;
    }
    .modal-head h3{margin:0; font-size:18px; font-weight:950}
    .modal-body{padding:14px}
    .divider{height:1px;background:var(--line);margin:12px 0}
    .row{display:flex; gap:12px; flex-wrap:wrap}
    .field{flex:1; min-width:220px}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px; font-weight:700}
    textarea{min-height:90px; resize:vertical}
    .help{font-size:12px; color:var(--muted2); margin-top:6px; line-height:1.35}

    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap:12px}
    @media(max-width:560px){.grid2{grid-template-columns:1fr}}

    .mini{
      font-size:12px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--muted);
    }
  </style>
</head>

<body>
  <div class="top">
    <div class="top-inner">
      <div class="brand">
        <div class="logo" aria-label="MertaX Butik">
          <svg width="26" height="26" viewBox="0 0 24 24" fill="none">
            <path d="M8 20c0-4.5 2.2-7.5 6.2-10.2C16.8 8 18 6 18 4" stroke="white" stroke-width="2.4" stroke-linecap="round"/>
            <path d="M6 6c5.5 0 9.5 3.4 9.5 9.2 0 3-1.5 4.8-3.5 4.8-2.5 0-3.7-2.2-3.7-4.4" stroke="white" stroke-width="2.4" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="btxt">
          <b>MertaX Butik</b>
          <small>–û–Ω–ª–∞—ò–Ω –Ω–∞—Ä–∞—á–∫–∏ –ø—Ä–µ–∫—É WhatsApp ‚Ä¢ –í–µ–ª–∏—á–∏–Ω–∏ ‚Ä¢ –ó–∞–ª–∏—Ö–∞</small>
        </div>
      </div>

      <div class="right-actions">
        <span class="chip" id="chipCat">–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞: ‚Äî</span>
        <button class="btn" id="btnCats">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
        <button class="btn ghost" id="btnAdmin">Admin</button>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="panel">
      <div class="products-head">
        <div>
          <div class="title">–ü—Ä–æ–¥—É–∫—Ç–∏</div>
          <div class="muted" id="prodInfo">0 –ø—Ä–æ–¥—É–∫—Ç–∏</div>
          <div class="howto">
            <b>–ö–∞–∫–æ –¥–∞ –Ω–∞—Ä–∞—á–∞—à?</b><br>
            1) –ò–∑–±–µ—Ä–∏ –ø—Ä–æ–¥—É–∫—Ç ‚Üí 2) –ü—Ä–∏—Ç–∏—Å–Ω–∏ ‚Äû–ù–∞—Ä–∞—á–∞—ò‚Äú ‚Üí 3) –ò–∑–±–µ—Ä–∏ –≤–µ–ª–∏—á–∏–Ω–∞ –∏ –∫–æ–ª–∏—á–∏–Ω–∞ ‚Üí 4) –ü–æ—Ç–≤—Ä–¥–∏ ‚Üí WhatsApp —ú–µ —Å–µ –æ—Ç–≤–æ—Ä–∏ —Å–æ –≥–æ—Ç–æ–≤–∞ –ø–æ—Ä–∞–∫–∞.
          </div>
        </div>
        <div class="row">
          <button class="btn primary" id="btnAddProd" title="–î–æ–¥–∞—ò –ø—Ä–æ–¥—É–∫—Ç (—Å–∞–º–æ Admin)">+ –ü—Ä–æ–¥—É–∫—Ç</button>
        </div>
      </div>

      <div class="filters">
        <input class="input" id="prodSearch" placeholder="–ü—Ä–µ–±–∞—Ä–∞—ò –ø—Ä–æ–¥—É–∫—Ç..." />
        <select class="select" id="sizeFilter">
          <option value="">–§–∏–ª—Ç–µ—Ä –ø–æ –≤–µ–ª–∏—á–∏–Ω–∞ (—Å–∞–º–æ –¥–æ—Å—Ç–∞–ø–Ω–∏)</option>
        </select>
        <button class="btn" id="btnResetFilters">Reset</button>
      </div>

      <div class="cards" id="cards"></div>

      <div class="footerbar">
        <div>üì≤ –ù–∞—Ä–∞—á–∫–∞ = WhatsApp –ø–æ—Ä–∞–∫–∞ (–ø—Ä–æ–¥—É–∫—Ç + —Ü–µ–Ω–∞ + –≤–µ–ª–∏—á–∏–Ω–∞ + –∫–æ–ª–∏—á–∏–Ω–∞)</div>
        <div>üß† –ü–æ–¥–∞—Ç–æ—Ü–∏ –ª–æ–∫–∞–ª–Ω–æ (localStorage)</div>
      </div>
    </div>
  </div>

  <!-- MODAL: Categories -->
  <div class="modal" id="modalCats">
    <div class="modal-card">
      <div class="modal-head">
        <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
        <button class="btn" onclick="UI.close('modalCats')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body" id="catsList"></div>
    </div>
  </div>

  <!-- MODAL: Admin -->
  <div class="modal" id="modalAdmin">
    <div class="modal-card">
      <div class="modal-head">
        <h3>Admin</h3>
        <button class="btn" onclick="UI.close('modalAdmin')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body">
        <div class="muted">–õ–æ–∫–∞–ª–µ–Ω Admin (—Å–∞–º–æ –Ω–∞ —Ç–≤–æ—ò–æ—Ç —É—Ä–µ–¥)</div>
        <div class="divider"></div>

        <div class="row">
          <div class="field">
            <label>Admin –ª–æ–∑–∏–Ω–∫–∞</label>
            <input class="input" id="adminPass" type="password" placeholder="–í–Ω–µ—Å–∏ –ª–æ–∑–∏–Ω–∫–∞..." />
            <div class="help">–°–æ–≤–µ—Ç: —Å—Ç–∞–≤–∏ —Å–∏–ª–Ω–∞ –ª–æ–∑–∏–Ω–∫–∞. –°–µ —á—É–≤–∞ –ª–æ–∫–∞–ª–Ω–æ –Ω–∞ —É—Ä–µ–¥–æ—Ç.</div>
          </div>
          <div class="field">
            <label>&nbsp;</label>
            <button class="btn primary" id="btnLogin">Login</button>
            <button class="btn" id="btnLogout">Logout</button>
          </div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <div class="field">
            <label>WhatsApp –±—Ä–æ—ò (–±–µ–∑ +, –ø—Ä–∏–º–µ—Ä 3897...)</label>
            <input class="input" id="shopWa" placeholder="38972912601" />
            <div class="help">–û–≤–æ—ò –±—Ä–æ—ò —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –∑–∞ —Å–∏—Ç–µ –Ω–∞—Ä–∞—á–∫–∏.</div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <button class="btn" id="btnSeedDemo">–°—Ç–∞–≤–∏ Demo –ø—Ä–æ–¥—É–∫—Ç–∏ (–≥–µ–Ω–µ—Ä–∏—Ä–∞)</button>
          <button class="btn danger" id="btnClearAll">–ò–∑–±—Ä–∏—à–∏ –°√à</button>
        </div>

        <div class="divider"></div>
        <div class="muted2 small">
          ‚úÖ Demo = 150 –ø—Ä–æ–¥—É–∫—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—ò–∞ (–¢—Ä–µ–Ω–µ—Ä–∫–∏/–à–∞–∫–Ω–∏/–û–¥–µ–ª–∞ = 70) <br>
          ‚úÖ –í–µ–ª–∏—á–∏–Ω–∏: S‚Äì3XL, –∞ –∑–∞ –§–∞—Ä–º–µ—Ä–∫–∏/–ü–∞–Ω—Ç–∞–ª–æ–Ω–∏: 30,31,32,33,34,36,38,40,42
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Product editor -->
  <div class="modal" id="modalProd">
    <div class="modal-card">
      <div class="modal-head">
        <h3 id="prodModalTitle">–ü—Ä–æ–¥—É–∫—Ç</h3>
        <div class="row">
          <button class="btn danger" id="btnDeleteProd">–ò–∑–±—Ä–∏—à–∏</button>
          <button class="btn" onclick="UI.close('modalProd')">–ó–∞—Ç–≤–æ—Ä–∏</button>
        </div>
      </div>
      <div class="modal-body">
        <div class="grid2">
          <div class="field">
            <label>–ò–º–µ</label>
            <input class="input" id="pName" placeholder="–ü—Ä–∏–º–µ—Ä: –ß–µ–º–ø–µ—Ä #001" />
          </div>
          <div class="field">
            <label>–¶–µ–Ω–∞ (–¥–µ–Ω)</label>
            <input class="input" id="pPrice" type="number" min="0" step="1" placeholder="1990" />
          </div>

          <div class="field">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞</label>
            <select class="select" id="pCat"></select>
          </div>

          <div class="field">
            <label>WhatsApp –±—Ä–æ—ò (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ, –∞–∫–æ —Å–∞–∫–∞—à —Ä–∞–∑–ª–∏—á–µ–Ω)</label>
            <input class="input" id="pWa" placeholder="–ø—Ä–∞–∑–Ω–æ = —ú–µ –∫–æ—Ä–∏—Å—Ç–∏ shop WhatsApp" />
            <div class="help">–ê–∫–æ –µ –ø—Ä–∞–∑–Ω–æ, –∫–æ—Ä–∏—Å—Ç–∏ –±—Ä–æ—ò–æ—Ç –æ–¥ Admin.</div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="field">
          <label>–û–ø–∏—Å</label>
          <textarea class="input" id="pDesc" placeholder="–ö—Ä–∞—Ç–æ–∫ –æ–ø–∏—Å..."></textarea>
        </div>

        <div class="divider"></div>

        <div class="field">
          <label>–°–ª–∏–∫–∏ (3‚Äì5 –ª–∏–Ω–∫–æ–≤–∏, –ø–æ —Ä–µ–¥, –µ–¥–Ω–∞ –ª–∏–Ω–∏—ò–∞ = –µ–¥–µ–Ω –ª–∏–Ω–∫)</label>
          <textarea class="input" id="pImgs" placeholder="https://..."></textarea>
          <div class="help">–°—Ç–∞–≤–∏ –Ω–∞—ò–º–∞–ª–∫—É 1 –ª–∏–Ω–∫. –ú–æ–∂–µ –∏ 3‚Äì5 –∑–∞ –≥–∞–ª–µ—Ä–∏—ò–∞.</div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <div class="field">
            <label>–¢–∏–ø –≤–µ–ª–∏—á–∏–Ω–∏</label>
            <select class="select" id="pSizeMode">
              <option value="clothes">–û–±–ª–µ–∫–∞ (S‚Äì3XL)</option>
              <option value="jeans">–§–∞—Ä–º–µ—Ä–∫–∏/–ü–∞–Ω—Ç–∞–ª–æ–Ω–∏ (30‚Äì42)</option>
            </select>
          </div>
          <div class="field">
            <label>&nbsp;</label>
            <span class="mini" id="sizeHint">S, M, L, XL, 2XL, 3XL</span>
          </div>
        </div>

        <div class="divider"></div>
        <div class="field">
          <label>–ó–∞–ª–∏—Ö–∞ –ø–æ –≤–µ–ª–∏—á–∏–Ω–∏ (–ø–æ–ø–æ–ª–Ω—É–≤–∞—à –±—Ä–æ—ò–∫–∏)</label>
          <div id="stockGrid" class="row"></div>
          <div class="help">–ö–æ–≥–∞ —ú–µ —Å–µ –Ω–∞–ø—Ä–∞–≤–∏ –Ω–∞—Ä–∞—á–∫–∞, –∑–∞–ª–∏—Ö–∞—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç—Å–∫–∏ —Å–µ –Ω–∞–º–∞–ª—É–≤–∞.</div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <button class="btn primary" id="btnSaveProd">–ó–∞—á—É–≤–∞—ò</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Product details -->
  <div class="modal" id="modalDetails">
    <div class="modal-card">
      <div class="modal-head">
        <h3 id="dTitle">–î–µ—Ç–∞–ª–∏</h3>
        <button class="btn" onclick="UI.close('modalDetails')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body">
        <div class="row" style="align-items:flex-start;">
          <img id="dImg" alt="" style="width:180px;height:120px;object-fit:cover;border-radius:14px;border:1px solid var(--line)" />
          <div style="flex:1; min-width:240px;">
            <div class="muted" id="dCat"></div>
            <div style="margin-top:6px;font-weight:950;font-size:18px" id="dPrice"></div>
            <div class="divider"></div>
            <div class="muted2" id="dDesc" style="white-space:pre-wrap"></div>
          </div>
        </div>

        <div class="divider"></div>
        <div class="muted small">–ì–∞–ª–µ—Ä–∏—ò–∞</div>
        <div class="row" id="dGallery"></div>
      </div>
    </div>
  </div>

  <!-- MODAL: Order -->
  <div class="modal" id="modalOrder">
    <div class="modal-card" style="max-width:720px;">
      <div class="modal-head">
        <h3>–ù–∞—Ä–∞—á–∫–∞</h3>
        <button class="btn" onclick="UI.close('modalOrder')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body">
        <div class="row" style="align-items:flex-start;">
          <img id="oImg" alt="" style="width:200px;height:135px;object-fit:cover;border-radius:14px;border:1px solid var(--line)" />
          <div style="flex:1; min-width:250px;">
            <div id="oTitle" style="font-weight:950;font-size:18px"></div>
            <div class="muted" id="oCat"></div>
            <div id="oPrice" style="margin-top:6px;font-weight:950;font-size:18px"></div>
            <div class="help">–ò–∑–±–µ—Ä–∏ –≤–µ–ª–∏—á–∏–Ω–∞ —à—Ç–æ –∏–º–∞ –∑–∞–ª–∏—Ö–∞ –∏ –≤–Ω–µ—Å–∏ –∫–æ–ª–∏—á–∏–Ω–∞.</div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="grid2">
          <div class="field">
            <label>–í–µ–ª–∏—á–∏–Ω–∞ (—Å–∞–º–æ –¥–æ—Å—Ç–∞–ø–Ω–∏)</label>
            <select class="select" id="oSize"></select>
          </div>
          <div class="field">
            <label>–ö–æ–ª–∏—á–∏–Ω–∞</label>
            <input class="input" id="oQty" type="number" min="1" step="1" value="1" />
          </div>

          <div class="field">
            <label>–ò–º–µ / –ü—Ä–µ–∑–∏–º–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)</label>
            <input class="input" id="cName" placeholder="–ü—Ä–∏–º–µ—Ä: –ï—Ä–µ–Ω" />
          </div>
          <div class="field">
            <label>–¢–µ–ª–µ—Ñ–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)</label>
            <input class="input" id="cPhone" placeholder="07x..." />
          </div>

          <div class="field" style="grid-column:1/-1">
            <label>–ê–¥—Ä–µ—Å–∞ / –ì—Ä–∞–¥ (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)</label>
            <input class="input" id="cAddr" placeholder="–ü—Ä–∏–º–µ—Ä: –°–∫–æ–ø—ò–µ, ... —É–ª–∏—Ü–∞ ..." />
          </div>

          <div class="field" style="grid-column:1/-1">
            <label>–ü–æ—Ä–∞–∫–∞ / –ó–∞–±–µ–ª–µ—à–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)</label>
            <textarea class="input" id="cNote" placeholder="–ë–æ—ò–∞, –Ω–∞–ø–æ–º–µ–Ω–∞, –∏—Å–ø–æ—Ä–∞–∫–∞..."></textarea>
          </div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <button class="btn primary" id="btnSendOrder">–ü—Ä–∞—Ç–∏ –Ω–∞ WhatsApp</button>
          <button class="btn" id="btnJustCopy">–ö–æ–ø–∏—Ä–∞—ò —Ç–µ–∫—Å—Ç</button>
        </div>

        <div class="help">
          ‚úÖ –°–æ ‚Äû–ü—Ä–∞—Ç–∏ –Ω–∞ WhatsApp‚Äú —Å–µ –Ω–∞–º–∞–ª—É–≤–∞ –∑–∞–ª–∏—Ö–∞—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç—Å–∫–∏ (—Å–∞–º–æ –∞–∫–æ –∏–º–∞ –¥–æ–≤–æ–ª–Ω–æ).<br>
          –ê–∫–æ —Å–∞–∫–∞—à –ø—Ä–≤–æ –¥–∞ —Ç–µ—Å—Ç–∏—Ä–∞—à –±–µ–∑ –¥–∞ –Ω–∞–º–∞–ª—É–≤–∞ –∑–∞–ª–∏—Ö–∞, –∫–∞–∂–∏ –º–∏ –∏ —ú–µ —Ç–∏ –¥–æ–¥–∞–¥–∞–º ‚ÄûTest mode‚Äú.
        </div>
      </div>
    </div>
  </div>

<script>
/* =========================
   MertaX Butik ‚Äî Single File
   ========================= */

const STORE_KEY = "mertax_butik_state_v1";

const SIZES_CLOTHES = ["S","M","L","XL","2XL","3XL"];
const SIZES_JEANS   = ["30","31","32","33","34","36","38","40","42"];

const DEFAULT_SHOP_WA = "38972912601"; // ‚úÖ –¢–≤–æ—ò–æ—Ç –±—Ä–æ—ò

const CATS = [
  {id:"c1", name:"–ß–µ–º–ø–µ—Ä–∏"},
  {id:"c2", name:"–ú–∞–∏—á–∫–∏"},
  {id:"c3", name:"–¢—Ä–µ–Ω–µ—Ä–∫–∏"},
  {id:"c4", name:"–à–∞–∫–Ω–∏"},
  {id:"c5", name:"–û–¥–µ–ª–∞"},
  {id:"c6", name:"–ë–ª—É–∑–æ–Ω–∏"},
  {id:"c7", name:"–§–∞—Ä–º–µ—Ä–∫–∏/–ü–∞–Ω—Ç–∞–ª–æ–Ω–∏"},
  {id:"c8", name:"–ü–∞—Ç–∏–∫–∏"},
];

const UI = {
  open(id){ document.getElementById(id).classList.add("open"); },
  close(id){ document.getElementById(id).classList.remove("open"); },
  toast(msg){ alert(msg); }
};

function uid(){
  return Math.random().toString(16).slice(2) + Date.now().toString(16);
}
function money(n){
  const x = Number(n||0);
  return x.toLocaleString("mk-MK") + " –¥–µ–Ω";
}
function catName(id){
  return (CATS.find(c=>c.id===id)||{name:"‚Äî"}).name;
}
function getSizes(mode){
  return mode==="jeans" ? SIZES_JEANS : SIZES_CLOTHES;
}
function safeNum(v){ const n = Number(v); return Number.isFinite(n) ? n : 0; }

let state = load();
let session = { isAdmin:false };
let view = { catId: state.activeCatId || CATS[0].id, q:"", size:"" };
let orderState = { prodId:null };

function load(){
  try{
    const raw = localStorage.getItem(STORE_KEY);
    if(raw){
      const s = JSON.parse(raw);
      // –º–∏–Ω–∏–º–∞–ª–Ω–∏ default-–∏
      if(!s.shop) s.shop = {};
      if(!s.shop.wa) s.shop.wa = DEFAULT_SHOP_WA;
      if(!Array.isArray(s.products)) s.products = [];
      if(!s.activeCatId) s.activeCatId = CATS[0].id;
      if(!s.adminPass) s.adminPass = "";
      return s;
    }
  }catch(e){}
  return {
    shop:{ wa: DEFAULT_SHOP_WA },
    adminPass:"",
    activeCatId: CATS[0].id,
    products:[]
  };
}
function save(){
  localStorage.setItem(STORE_KEY, JSON.stringify(state));
}

/* ==============
   Render helpers
   ============== */

function buildCats(){
  const wrap = document.getElementById("catsList");
  wrap.innerHTML = "";
  CATS.forEach(c=>{
    const btn = document.createElement("button");
    btn.className = "btn";
    btn.style.width = "100%";
    btn.style.justifyContent="space-between";
    btn.innerHTML = `<span>${c.name}</span><span class="mini">${countCat(c.id)}</span>`;
    btn.onclick = ()=>{
      view.catId = c.id;
      state.activeCatId = c.id;
      save();
      UI.close("modalCats");
      renderAll();
    };
    wrap.appendChild(btn);
    wrap.appendChild(document.createElement("div")).style.height="10px";
  });
}
function countCat(catId){
  return state.products.filter(p=>p.catId===catId).length;
}

function availableSizes(p){
  return Object.entries(p.stock||{})
    .filter(([k,v])=>safeNum(v)>0)
    .map(([k])=>k);
}
function totalStock(p){
  return Object.values(p.stock||{}).reduce((a,v)=>a+safeNum(v),0);
}

function buildSizeFilter(){
  const sel = document.getElementById("sizeFilter");
  const catProds = state.products.filter(p=>p.catId===view.catId);
  const set = new Set();
  catProds.forEach(p=>{
    availableSizes(p).forEach(s=>set.add(s));
  });
  const current = sel.value || "";
  sel.innerHTML = `<option value="">–§–∏–ª—Ç–µ—Ä –ø–æ –≤–µ–ª–∏—á–∏–Ω–∞ (—Å–∞–º–æ –¥–æ—Å—Ç–∞–ø–Ω–∏)</option>`;
  [...set].sort((a,b)=>{
    // –¥–∞ –Ω–µ –º–µ—à–∞ –±—Ä–æ—ò–∫–∏ –∏ –±—É–∫–≤–∏ —Ö–∞–æ—Ç–∏—á–Ω–æ
    const na = Number(a), nb = Number(b);
    if(Number.isFinite(na) && Number.isFinite(nb)) return na-nb;
    return a.localeCompare(b);
  }).forEach(s=>{
    const opt = document.createElement("option");
    opt.value = s;
    opt.textContent = s;
    sel.appendChild(opt);
  });
  sel.value = current;
}

function matchProduct(p){
  if(p.catId !== view.catId) return false;
  if(view.q){
    const t = (p.name+" "+(p.desc||"")).toLowerCase();
    if(!t.includes(view.q.toLowerCase())) return false;
  }
  if(view.size){
    if(safeNum((p.stock||{})[view.size])<=0) return false;
  }
  return true;
}

function renderCards(){
  const cards = document.getElementById("cards");
  cards.innerHTML = "";

  const list = state.products.filter(matchProduct);

  document.getElementById("prodInfo").textContent = `${list.length} –ø—Ä–æ–¥—É–∫—Ç–∏`;
  document.getElementById("chipCat").textContent = `–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞: ${catName(view.catId)}`;

  list.forEach(p=>{
    const img = (p.images && p.images[0]) ? p.images[0] : "";
    const tot = totalStock(p);
    const badge = tot>0 ? "–î–æ—Å—Ç–∞–ø–Ω–æ" : "–ù–µ–º–∞ –∑–∞–ª–∏—Ö–∞";
    const badgeColor = tot>0 ? "" : "style='border-color: rgba(239,68,68,.35); background: rgba(239,68,68,.12)'";

    const c = document.createElement("div");
    c.className="card";
    c.innerHTML = `
      <div class="imgwrap">
        <img src="${img}" alt="">
        <div class="badge" ${badgeColor}>${badge}</div>
      </div>
      <div class="cardbody">
        <div class="pname">${escapeHtml(p.name)}</div>
        <div class="meta">
          <div class="muted">${catName(p.catId)}</div>
          <div class="price">${money(p.price)}</div>
        </div>
        <div class="sizes">${renderSizeChips(p)}</div>
        <div class="actions">
          <button class="btn primary" ${tot>0 ? "" : "disabled style='opacity:.5;cursor:not-allowed'"}>–ù–∞—Ä–∞—á–∞—ò</button>
          <button class="btn">–î–µ—Ç–∞–ª–∏</button>
        </div>
      </div>
    `;
    const btnOrder = c.querySelectorAll("button")[0];
    const btnDet   = c.querySelectorAll("button")[1];
    btnOrder.onclick = ()=> openOrderModal(p);
    btnDet.onclick   = ()=> openDetails(p);

    cards.appendChild(c);
  });

  if(list.length===0){
    const empty = document.createElement("div");
    empty.className="muted";
    empty.style.padding="18px";
    empty.textContent = "–ù–µ–º–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ –∑–∞ –∏–∑–±—Ä–∞–Ω–∏–æ—Ç —Ñ–∏–ª—Ç–µ—Ä.";
    cards.appendChild(empty);
  }
}

function renderSizeChips(p){
  const sizes = getSizes(p.sizeMode||"clothes");
  return sizes.map(s=>{
    const v = safeNum((p.stock||{})[s]);
    const dot = v>0 ? "g" : "r";
    return `<span class="sz"><span class="dot ${dot}"></span>${s} (${v})</span>`;
  }).join("");
}

function renderAll(){
  buildCats();
  fillProdCatSelect();
  buildSizeFilter();
  renderCards();
  syncAdminUI();
}

/* ============
   Product edit
   ============ */

let editingProdId = null;

function requireAdmin(){
  if(!session.isAdmin){
    UI.toast("–û–≤–∞ –µ —Å–∞–º–æ –∑–∞ Admin. –í–ª–µ–∑–∏ –≤–æ Admin –ø—Ä–≤–æ.");
    UI.open("modalAdmin");
    return false;
  }
  return true;
}

function fillProdCatSelect(){
  const sel = document.getElementById("pCat");
  sel.innerHTML = "";
  CATS.forEach(c=>{
    const opt=document.createElement("option");
    opt.value=c.id;
    opt.textContent=c.name;
    sel.appendChild(opt);
  });
}

function openProdEditor(prod){
  if(!requireAdmin()) return;

  editingProdId = prod ? prod.id : null;
  document.getElementById("prodModalTitle").textContent = prod ? "–ò–∑–º–µ–Ω–∏ –ø—Ä–æ–¥—É–∫—Ç" : "–ù–æ–≤ –ø—Ä–æ–¥—É–∫—Ç";
  document.getElementById("btnDeleteProd").style.display = prod ? "inline-flex" : "none";

  const p = prod || {
    id: uid(),
    name:"",
    price:0,
    catId:view.catId,
    wa:"",
    desc:"",
    images:[],
    sizeMode:"clothes",
    stock: makeStock("clothes", 0)
  };

  document.getElementById("pName").value = p.name;
  document.getElementById("pPrice").value = p.price;
  document.getElementById("pCat").value = p.catId;
  document.getElementById("pWa").value = p.wa || "";
  document.getElementById("pDesc").value = p.desc || "";
  document.getElementById("pImgs").value = (p.images||[]).join("\n");
  document.getElementById("pSizeMode").value = p.sizeMode || "clothes";

  updateSizeHint();
  buildStockInputs(p);

  UI.open("modalProd");

  document.getElementById("btnSaveProd").onclick = ()=>{
    const mode = document.getElementById("pSizeMode").value;
    const stock = readStockInputs(mode);

    const images = document.getElementById("pImgs").value
      .split("\n").map(s=>s.trim()).filter(Boolean);

    const out = {
      id: p.id,
      name: document.getElementById("pName").value.trim() || "–ë–µ–∑ –∏–º–µ",
      price: safeNum(document.getElementById("pPrice").value),
      catId: document.getElementById("pCat").value,
      wa: document.getElementById("pWa").value.trim(),
      desc: document.getElementById("pDesc").value.trim(),
      images,
      sizeMode: mode,
      stock
    };

    const idx = state.products.findIndex(x=>x.id===out.id);
    if(idx>=0) state.products[idx] = out;
    else state.products.unshift(out);

    save();
    UI.close("modalProd");
    renderAll();
  };

  document.getElementById("btnDeleteProd").onclick = ()=>{
    if(!confirm("–°–∏–≥—É—Ä–Ω–æ —Å–∞–∫–∞—à –¥–∞ –≥–æ –∏–∑–±—Ä–∏—à–µ—à –ø—Ä–æ–¥—É–∫—Ç–æ—Ç?")) return;
    state.products = state.products.filter(x=>x.id!==p.id);
    save();
    UI.close("modalProd");
    renderAll();
  };
}

function updateSizeHint(){
  const mode = document.getElementById("pSizeMode").value;
  document.getElementById("sizeHint").textContent = getSizes(mode).join(", ");
}
document.getElementById("pSizeMode").addEventListener("change", ()=>{
  updateSizeHint();
  buildStockInputs({ sizeMode: document.getElementById("pSizeMode").value, stock:{} });
});

function makeStock(mode, fill){
  const st = {};
  getSizes(mode).forEach(s=>st[s]=fill);
  return st;
}

function buildStockInputs(p){
  const mode = document.getElementById("pSizeMode").value;
  const sizes = getSizes(mode);
  const wrap = document.getElementById("stockGrid");
  wrap.innerHTML = "";

  sizes.forEach(s=>{
    const v = safeNum((p.stock||{})[s]);
    const box = document.createElement("div");
    box.className="field";
    box.style.minWidth="140px";
    box.innerHTML = `
      <label>${s}</label>
      <input class="input stockIn" data-size="${s}" type="number" min="0" step="1" value="${v}">
    `;
    wrap.appendChild(box);
  });
}

function readStockInputs(mode){
  const st = makeStock(mode, 0);
  document.querySelectorAll(".stockIn").forEach(inp=>{
    const s = inp.getAttribute("data-size");
    st[s] = Math.max(0, parseInt(inp.value||"0",10) || 0);
  });
  return st;
}

/* ===========
   Product view
   =========== */

function openDetails(p){
  document.getElementById("dTitle").textContent = p.name;
  document.getElementById("dCat").textContent = catName(p.catId);
  document.getElementById("dPrice").textContent = money(p.price);
  document.getElementById("dDesc").textContent = p.desc || "‚Äî";
  document.getElementById("dImg").src = (p.images&&p.images[0])?p.images[0]:"";

  const g = document.getElementById("dGallery");
  g.innerHTML="";
  (p.images||[]).slice(0,5).forEach(url=>{
    const im=document.createElement("img");
    im.src=url;
    im.alt="";
    im.style.width="110px";
    im.style.height="80px";
    im.style.objectFit="cover";
    im.style.borderRadius="12px";
    im.style.border="1px solid var(--line)";
    im.style.cursor="pointer";
    im.onclick=()=>{ document.getElementById("dImg").src=url; };
    g.appendChild(im);
  });

  UI.open("modalDetails");
}

/* ===========
   Order system
   =========== */

function openOrderModal(p){
  orderState.prodId = p.id;

  document.getElementById("oImg").src = (p.images&&p.images[0])?p.images[0]:"";
  document.getElementById("oTitle").textContent = p.name;
  document.getElementById("oCat").textContent = catName(p.catId);
  document.getElementById("oPrice").textContent = money(p.price);

  // Build size options (only available)
  const sel = document.getElementById("oSize");
  sel.innerHTML = "";
  const sizes = getSizes(p.sizeMode||"clothes");
  const av = sizes.filter(s=>safeNum((p.stock||{})[s])>0);

  if(av.length===0){
    const opt=document.createElement("option");
    opt.value="";
    opt.textContent="–ù–µ–º–∞ –∑–∞–ª–∏—Ö–∞";
    sel.appendChild(opt);
    document.getElementById("btnSendOrder").disabled = true;
  }else{
    av.forEach(s=>{
      const opt=document.createElement("option");
      opt.value=s;
      opt.textContent = `${s} (–æ—Å—Ç–∞–Ω–∞—Ç–æ: ${safeNum(p.stock[s])})`;
      sel.appendChild(opt);
    });
    document.getElementById("btnSendOrder").disabled = false;
  }

  document.getElementById("oQty").value = 1;
  document.getElementById("cName").value = "";
  document.getElementById("cPhone").value = "";
  document.getElementById("cAddr").value = "";
  document.getElementById("cNote").value = "";

  UI.open("modalOrder");
}

function orderMessage(p, size, qty){
  const name = (document.getElementById("cName").value||"").trim();
  const phone = (document.getElementById("cPhone").value||"").trim();
  const addr = (document.getElementById("cAddr").value||"").trim();
  const note = (document.getElementById("cNote").value||"").trim();

  let msg =
`–ó–¥—Ä–∞–≤–æ, —Å–∞–∫–∞–º –¥–∞ –Ω–∞—Ä–∞—á–∞–º:
‚Ä¢ –ü—Ä–æ–¥—É–∫—Ç: ${p.name}
‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞: ${catName(p.catId)}
‚Ä¢ –¶–µ–Ω–∞: ${money(p.price)}
‚Ä¢ –í–µ–ª–∏—á–∏–Ω–∞: ${size}
‚Ä¢ –ö–æ–ª–∏—á–∏–Ω–∞: ${qty}`;

  if(name)  msg += `\n‚Ä¢ –ò–º–µ: ${name}`;
  if(phone) msg += `\n‚Ä¢ –¢–µ–ª–µ—Ñ–æ–Ω: ${phone}`;
  if(addr)  msg += `\n‚Ä¢ –ê–¥—Ä–µ—Å–∞: ${addr}`;
  if(note)  msg += `\n‚Ä¢ –ó–∞–±–µ–ª–µ—à–∫–∞: ${note}`;

  msg += `\n\n(–ü—Ä–∞—Ç–µ–Ω–æ –æ–¥ MertaX Butik)`;
  return msg;
}

function sendWhatsApp(phoneDigits, text){
  const phone = (phoneDigits||"").replace(/\D/g,"");
  if(!phone){
    UI.toast("–ù–µ–º–∞ –≤–Ω–µ—Å–µ–Ω WhatsApp –±—Ä–æ—ò (–≤–æ Admin).");
    return;
  }
  const url = "https://wa.me/" + phone + "?text=" + encodeURIComponent(text);
  window.open(url, "_blank");
}

function decrementStock(p, size, qty){
  const current = safeNum((p.stock||{})[size]);
  if(qty>current) return false;
  p.stock[size] = Math.max(0, current - qty);
  return true;
}

document.getElementById("btnSendOrder").onclick = ()=>{
  const p = state.products.find(x=>x.id===orderState.prodId);
  if(!p){ UI.toast("–ì—Ä–µ—à–∫–∞: –ø—Ä–æ–¥—É–∫—Ç –Ω–µ –µ –Ω–∞—ò–¥–µ–Ω."); return; }

  const size = document.getElementById("oSize").value;
  const qty = Math.max(1, parseInt(document.getElementById("oQty").value||"1",10) || 1);

  if(!size){ UI.toast("–ù–µ–º–∞ –¥–æ—Å—Ç–∞–ø–Ω–∞ –≤–µ–ª–∏—á–∏–Ω–∞."); return; }
  if(qty<=0){ UI.toast("–ö–æ–ª–∏—á–∏–Ω–∞ –º–æ—Ä–∞ –¥–∞ –µ 1 –∏–ª–∏ –ø–æ–≤–µ—ú–µ."); return; }

  if(!decrementStock(p, size, qty)){
    UI.toast("–ù–µ–º–∞–º–µ —Ç–æ–ª–∫—É –∑–∞–ª–∏—Ö–∞ –∑–∞ —Ç–∞–∞ –≤–µ–ª–∏—á–∏–Ω–∞.");
    return;
  }

  save();
  renderAll();

  const msg = orderMessage(p, size, qty);
  const phone = (p.wa && p.wa.trim()) ? p.wa.trim() : (state.shop.wa || DEFAULT_SHOP_WA);
  sendWhatsApp(phone, msg);

  UI.close("modalOrder");
};

document.getElementById("btnJustCopy").onclick = ()=>{
  const p = state.products.find(x=>x.id===orderState.prodId);
  if(!p){ UI.toast("–ì—Ä–µ—à–∫–∞: –ø—Ä–æ–¥—É–∫—Ç –Ω–µ –µ –Ω–∞—ò–¥–µ–Ω."); return; }

  const size = document.getElementById("oSize").value;
  const qty = Math.max(1, parseInt(document.getElementById("oQty").value||"1",10) || 1);
  if(!size){ UI.toast("–ù–µ–º–∞ –¥–æ—Å—Ç–∞–ø–Ω–∞ –≤–µ–ª–∏—á–∏–Ω–∞."); return; }

  const msg = orderMessage(p, size, qty);
  navigator.clipboard?.writeText(msg);
  UI.toast("–ü–æ—Ä–∞–∫–∞—Ç–∞ –µ –∫–æ–ø–∏—Ä–∞–Ω–∞ ‚úÖ");
};

/* ===========
   Admin logic
   =========== */

function syncAdminUI(){
  document.getElementById("btnAddProd").style.display = session.isAdmin ? "inline-flex" : "none";
  document.getElementById("shopWa").value = state.shop.wa || DEFAULT_SHOP_WA;
}

function login(pass){
  if((pass||"") === (state.adminPass||"")){
    session.isAdmin = true;
    return true;
  }
  return false;
}

document.getElementById("btnLogin").onclick = ()=>{
  const pass = document.getElementById("adminPass").value || "";
  if(!state.adminPass){
    // –ø—Ä–≤–æ –ø–æ—Å—Ç–∞–≤—É–≤–∞—ö–µ –ª–æ–∑–∏–Ω–∫–∞
    if(!pass.trim()){
      UI.toast("–í–Ω–µ—Å–∏ –ª–æ–∑–∏–Ω–∫–∞ –∑–∞ –¥–∞ —ò–∞ –ø–æ—Å—Ç–∞–≤–∏—à.");
      return;
    }
    state.adminPass = pass.trim();
    save();
    session.isAdmin = true;
    UI.toast("Admin –ª–æ–∑–∏–Ω–∫–∞ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ ‚úÖ");
    UI.close("modalAdmin");
    renderAll();
    return;
  }

  if(login(pass.trim())){
    UI.toast("Login —É—Å–ø–µ—à–µ–Ω ‚úÖ");
    UI.close("modalAdmin");
    renderAll();
  }else{
    UI.toast("–ü–æ–≥—Ä–µ—à–Ω–∞ –ª–æ–∑–∏–Ω–∫–∞.");
  }
};

document.getElementById("btnLogout").onclick = ()=>{
  session.isAdmin = false;
  UI.toast("Logout ‚úÖ");
  UI.close("modalAdmin");
  renderAll();
};

document.getElementById("shopWa").addEventListener("input", ()=>{
  state.shop.wa = (document.getElementById("shopWa").value||"").replace(/\D/g,"");
  save();
});

document.getElementById("btnSeedDemo").onclick = ()=>{
  if(!requireAdmin()) return;
  if(!confirm("–°–∏–≥—É—Ä–Ω–æ —Å–∞–∫–∞—à –¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞—à Demo –ø—Ä–æ–¥—É–∫—Ç–∏? (—ú–µ –¥–æ–¥–∞–¥–µ –º–Ω–æ–≥—É –ø—Ä–æ–¥—É–∫—Ç–∏)")) return;
  seedDemoProducts();
  save();
  renderAll();
  UI.toast("Demo –ø—Ä–æ–¥—É–∫—Ç–∏ —Å–µ –¥–æ–¥–∞–¥–µ–Ω–∏ ‚úÖ");
};

document.getElementById("btnClearAll").onclick = ()=>{
  if(!requireAdmin()) return;
  if(!confirm("–û–≤–∞ —ú–µ –∏–∑–±—Ä–∏—à–µ –°–ò–¢–ï –ø—Ä–æ–¥—É–∫—Ç–∏. –°–∏–≥—É—Ä–Ω–æ?")) return;
  state.products = [];
  save();
  renderAll();
  UI.toast("–°√® –∏–∑–±—Ä–∏—à–∞–Ω–æ ‚úÖ");
};

function seedDemoProducts(){
  // –∞–∫–æ –≤–µ—ú–µ –∏–º–∞ –º–Ω–æ–≥—É, –Ω–µ –¥–æ–¥–∞–≤–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ
  if(state.products.length > 30){
    if(!confirm("–í–µ—ú–µ –∏–º–∞—à –ø—Ä–æ–¥—É–∫—Ç–∏. –î–∞ –¥–æ–¥–∞–¥–µ —É—à—Ç–µ?")) return;
  }

  const demoImg = (seed)=>`https://picsum.photos/seed/${seed}/900/560`;

  const perCat = (catName)=>{
    const nm = catName.toLowerCase();
    if(nm.includes("—Ç—Ä–µ–Ω–µ—Ä–∫–∏")) return 70;
    if(nm.includes("—ò–∞–∫–Ω–∏")) return 70;
    if(nm.includes("–æ–¥–µ–ª–∞")) return 70;
    return 150;
  };

  CATS.forEach((cat,ci)=>{
    const count = perCat(cat.name);
    for(let i=1;i<=count;i++){
      const isJeans = cat.name.includes("–§–∞—Ä–º–µ—Ä–∫–∏");
      const mode = isJeans ? "jeans" : "clothes";
      const sizes = getSizes(mode);

      // stock random
      const stock = {};
      sizes.forEach(s=>{
        const v = Math.random()<0.25 ? 0 : Math.floor(Math.random()*6); // 0..5
        stock[s]=v;
      });

      // price by category
      let price = 1490 + Math.floor(Math.random()*2500);
      const nm = cat.name.toLowerCase();
      if(nm.includes("–ø–∞—Ç–∏–∫–∏")) price = 2490 + Math.floor(Math.random()*3500);
      if(nm.includes("—ò–∞–∫–Ω–∏")) price = 2990 + Math.floor(Math.random()*4500);
      if(nm.includes("–æ–¥–µ–ª–∞")) price = 3490 + Math.floor(Math.random()*5500);

      const seed = `mertax_${ci}_${i}`;
      const imgs = [
        demoImg(seed+"a"),
        demoImg(seed+"b"),
        demoImg(seed+"c"),
      ];

      state.products.push({
        id: uid(),
        name: `${cat.name} #${String(i).padStart(3,"0")}`,
        price,
        catId: cat.id,
        wa: "",
        desc: "Demo –ø—Ä–æ–¥—É–∫—Ç (–∑–∞–º–µ–Ω–∏ —Å–æ —Ä–µ–∞–ª–µ–Ω –æ–ø–∏—Å).",
        images: imgs,
        sizeMode: mode,
        stock
      });
    }
  });

  // start cat
  state.activeCatId = CATS[0].id;
}

/* ==========
   Page wiring
   ========== */

document.getElementById("btnCats").onclick = ()=> UI.open("modalCats");
document.getElementById("btnAdmin").onclick = ()=> UI.open("modalAdmin");
document.getElementById("btnAddProd").onclick = ()=> openProdEditor(null);

document.getElementById("prodSearch").addEventListener("input", (e)=>{
  view.q = e.target.value || "";
  renderAll();
});
document.getElementById("sizeFilter").addEventListener("change", (e)=>{
  view.size = e.target.value || "";
  renderAll();
});
document.getElementById("btnResetFilters").onclick = ()=>{
  view.q = "";
  view.size = "";
  document.getElementById("prodSearch").value = "";
  document.getElementById("sizeFilter").value = "";
  renderAll();
};

// Click outside to close modals
["modalCats","modalAdmin","modalProd","modalDetails","modalOrder"].forEach(id=>{
  const m=document.getElementById(id);
  m.addEventListener("click",(e)=>{
    if(e.target===m) UI.close(id);
  });
});

function escapeHtml(s){
  return (s||"").replace(/[&<>"']/g, m=>({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));
}

/* init */
renderAll();
</script>
</body>
</html>

<!doctype html>
<html lang="mk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MertaX Butik</title>
  <style>
    :root{
      --bg:#0b0b0b;
      --card:rgba(20,20,20,.70);
      --card2:rgba(16,16,16,.82);
      --line:rgba(255,255,255,.10);
      --txt:#fff;
      --muted:rgba(255,255,255,.70);
      --muted2:rgba(255,255,255,.55);
      --accent:#22c55e;
      --accent2:#16a34a;
      --danger:#ef4444;
      --chip:rgba(255,255,255,.06);
      --shadow:0 14px 38px rgba(0,0,0,.45);
      --radius:20px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--txt);
      background:
        radial-gradient(1200px 700px at 20% 0%, rgba(34,197,94,.22), transparent 60%),
        radial-gradient(900px 500px at 90% 10%, rgba(34,197,94,.14), transparent 55%),
        linear-gradient(#070707, #0b0b0b 35%, #070707);
      min-height:100vh;
    }

    .wrap{max-width:1180px;margin:0 auto;padding:14px 14px 40px;}

    /* HEADER */
    .top{
      position:sticky;top:0;z-index:20;
      backdrop-filter: blur(10px);
      background: rgba(0,0,0,.45);
      border-bottom:1px solid var(--line);
    }
    .top-inner{
      max-width:1180px;margin:0 auto;
      padding:12px 14px;
      display:flex;align-items:center;gap:12px;
      justify-content:space-between;
    }
    .left{display:flex;align-items:center;gap:12px;min-width:260px;}
    .hamb{
      width:44px;height:44px;border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--txt);
      display:inline-flex;align-items:center;justify-content:center;
      cursor:pointer;
    }
    .hamb:active{transform:scale(.98)}
    .brand{
      display:flex;align-items:center;gap:12px;
      cursor:pointer;
      user-select:none;
    }
    .logo{
      width:56px;height:56px;border-radius:14px;overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
      display:flex;align-items:center;justify-content:center;
      flex:0 0 56px;
    }
    .logo img{width:100%;height:100%;object-fit:cover;display:block}
    .btxt b{display:block;font-size:28px;line-height:1.05;letter-spacing:.5px}
    .btxt .sub{display:block;color:var(--muted);font-size:14px;margin-top:4px}
    .right{
      display:flex;align-items:center;gap:10px;
      justify-content:flex-end;
      min-width:240px;
    }

    .btn{
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--txt);
      border-radius:16px;
      padding:12px 14px;
      cursor:pointer;
      font-weight:800;
      letter-spacing:.2px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      min-height:44px;
    }
    .btn.primary{
      background:linear-gradient(180deg, rgba(34,197,94,.22), rgba(34,197,94,.12));
      border-color:rgba(34,197,94,.35);
      box-shadow:0 10px 26px rgba(34,197,94,.10);
    }
    .btn:active{transform:scale(.99)}
    .btn.small{padding:10px 12px;border-radius:14px;font-weight:800}
    .btn.danger{border-color:rgba(239,68,68,.45);background:rgba(239,68,68,.10)}

    .search{
      flex:1;
      max-width:520px;
      display:flex;gap:10px;align-items:center;
      margin-left:10px;
    }
    .search input{
      width:100%;
      height:44px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--txt);
      padding:0 14px;
      outline:none;
    }
    .actions{
      display:flex;align-items:center;gap:10px;
    }
    .chip{
      border:1px solid var(--line);
      background:var(--chip);
      border-radius:999px;
      padding:8px 10px;
      color:var(--muted);
      font-size:12.5px;
      max-width:48vw;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }

    /* MAIN */
    .panel{
      margin-top:16px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.35);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panel-head{
      padding:18px 18px;
      border-bottom:1px solid var(--line);
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:12px;
    }
    .panel-head .h{
      font-size:34px;
      font-weight:900;
      letter-spacing:.4px;
    }
    .panel-head .muted{color:var(--muted);margin-top:4px}
    .panel-body{padding:18px}

    .filters{
      display:flex;gap:12px;flex-wrap:wrap;align-items:center;
      margin:14px 0 6px;
    }
    select, input[type="number"], input[type="text"], textarea{
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--txt);
      border-radius:16px;
      padding:12px 12px;
      outline:none;
      width:100%;
    }
    .filters .w240{min-width:240px}
    .filters .w320{min-width:320px}

    .grid{
      margin-top:14px;
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:12px;
    }
    @media (max-width:980px){ .grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:560px){
      .grid{grid-template-columns:1fr}
      .top-inner{flex-wrap:wrap;gap:10px}
      .left{flex:1 1 100%}
      .search{display:none !important}
      .btxt .sub{display:none}
      .chip{display:none}
      .actions{width:100%;justify-content:flex-end;gap:10px}
    }

    .card{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius:18px;
      overflow:hidden;
      box-shadow:0 10px 24px rgba(0,0,0,.35);
      display:flex;flex-direction:column;
      min-height:360px;
    }
    .imgwrap{
      position:relative;
      aspect-ratio: 16/10;
      background: rgba(255,255,255,.03);
      overflow:hidden;
    }
    .imgwrap img{width:100%;height:100%;object-fit:cover;display:block}
    .badge{
      position:absolute;top:10px;left:10px;
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:900;
      border:1px solid var(--line);
      background: rgba(0,0,0,.45);
      backdrop-filter: blur(6px);
    }
    .cardbody{padding:12px 12px 12px}
    .pname{font-size:22px;font-weight:900;letter-spacing:.3px}
    .price{margin-top:6px;font-size:34px;font-weight:1000;color:var(--accent)}
    .meta{
      margin-top:6px;
      display:flex;justify-content:space-between;gap:10px;
      color:var(--muted);
      font-size:13px;
    }

    .sizes{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
    .sz{
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      padding:6px 8px;
      border-radius:999px;
      font-size:12.5px;
      display:inline-flex;gap:6px;align-items:center;
      color:var(--muted);
    }
    .dot{width:10px;height:10px;border-radius:999px;display:inline-block}
    .dot.ok{background:var(--accent)}
    .dot.no{background:var(--danger)}

    .cardbtns{
      margin-top:12px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .cta{
      height:52px;border-radius:18px;
      font-weight:900;font-size:18px;
    }
    .cta.order{background:linear-gradient(180deg, rgba(34,197,94,.24), rgba(34,197,94,.12));border-color:rgba(34,197,94,.35)}
    .cta.details{background:rgba(255,255,255,.06)}
    .cta:disabled{opacity:.45;cursor:not-allowed}

    /* MODAL */
    .modal{
      position:fixed;inset:0;z-index:50;
      display:none;
      align-items:center;justify-content:center;
      padding:14px;
      background: rgba(0,0,0,.62);
      backdrop-filter: blur(8px);
    }
    .modal.show{display:flex}
    .modal-card{
      width:min(760px, 100%);
      border-radius:24px;
      border:1px solid var(--line);
      background: rgba(16,16,16,.88);
      box-shadow: 0 24px 70px rgba(0,0,0,.6);
      overflow:hidden;
    }
    .modal-head{
      padding:14px 14px;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      border-bottom:1px solid var(--line);
    }
    .modal-head h3{margin:0;font-size:18px}
    .modal-body{padding:14px}
    .divider{height:1px;background:var(--line);margin:12px 0}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .field{flex:1;min-width:220px}
    label{display:block;font-size:12px;color:var(--muted);margin:0 0 6px}
    textarea{min-height:90px;resize:vertical}
    .help{font-size:12px;color:var(--muted2);margin-top:6px}
    .mini{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--muted)}
  </style>
</head>

<body>
  <div class="top">
    <div class="top-inner">
      <div class="left">
        <button class="hamb" id="btnCats" title="–ö–∞—Ç–µ–≥–æ—Ä–∏–∏">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>

        <div class="brand" id="brandClick" title="–ü–æ—á–µ—Ç–Ω–∞">
          <div class="logo">
            <!-- –°–ª–∏–∫–∞—Ç–∞ –º–æ—Ä–∞ –¥–∞ –ø–æ—Å—Ç–æ–∏ –≤–æ —Ä–µ–ø–æ—Ç–æ —Å–æ –∏—Å—Ç–æ –∏–º–µ -->
            <img src="IMG_9833.jpeg" alt="MertaX Butik" />
          </div>
          <div class="btxt">
            <b>MertaX Butik</b>
            <span class="sub">–û–Ω–ª–∞—ò–Ω –Ω–∞—Ä–∞—á–∫–∏ –ø—Ä–µ–∫—É WhatsApp ‚Ä¢ –í–µ–ª–∏—á–∏–Ω–∏ ‚Ä¢ –ó–∞–ª–∏—Ö–∞</span>
          </div>
        </div>
      </div>

      <div class="search">
        <input id="qTop" placeholder="–ü—Ä–µ–±–∞—Ä–∞—ò –ø—Ä–æ–¥—É–∫—Ç..." />
        <span class="chip" id="chipInfo">–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞: (—Å–∏—Ç–µ) ‚Ä¢ –§–∏–ª—Ç–µ—Ä: –¥–æ—Å—Ç–∞–ø–Ω–∏</span>
      </div>

      <div class="right">
        <div class="actions">
          <!-- –û–≤–∞ —ú–µ —Å–µ –ø—Ä–∏–∫–∞–∂–µ —Å–∞–º–æ –∫–æ–≥–∞ —Å–∏ Admin -->
          <button class="btn primary" id="btnAdd" style="display:none">+ –ü—Ä–æ–¥—É–∫—Ç</button>

          <button class="btn" id="btnAdmin">Admin</button>
        </div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="panel">
      <div class="panel-head">
        <div>
          <div class="h">–ü—Ä–æ–¥—É–∫—Ç–∏</div>
          <div class="muted" id="countInfo">0 –ø—Ä–æ–¥—É–∫—Ç–∏</div>
          <div class="muted" style="margin-top:10px">
            <b>–ö–∞–∫–æ –¥–∞ –Ω–∞—Ä–∞—á–∞—à?</b><br>
            1) –ò–∑–±–µ—Ä–∏ –ø—Ä–æ–¥—É–∫—Ç ‚Üí 2) –ü—Ä–∏—Ç–∏—Å–Ω–∏ ‚Äû–ù–∞—Ä–∞—á–∞—ò‚Äú ‚Üí 3) –ò–∑–±–µ—Ä–∏ –≤–µ–ª–∏—á–∏–Ω–∞ –∏ –∫–æ–ª–∏—á–∏–Ω–∞ ‚Üí 4) –ü–æ—Ç–≤—Ä–¥–∏ ‚Üí WhatsApp —ú–µ —Å–µ –æ—Ç–≤–æ—Ä–∏ —Å–æ –≥–æ—Ç–æ–≤–∞ –ø–æ—Ä–∞–∫–∞.
          </div>
        </div>
      </div>

      <div class="panel-body">
        <div class="filters">
          <div class="w320">
            <input id="q" placeholder="–ü—Ä–µ–±–∞—Ä–∞—ò –ø—Ä–æ–¥—É–∫—Ç..." />
          </div>

          <div class="w240">
            <select id="catSel"></select>
          </div>

          <div class="w240">
            <select id="sizeFilter">
              <option value="">–§–∏–ª—Ç–µ—Ä –ø–æ –≤–µ–ª–∏—á–∏–Ω–∞ (—Å–∞–º–æ –¥–æ—Å—Ç–∞–ø–Ω–∏)</option>
            </select>
          </div>

          <button class="btn small" id="btnReset">Reset</button>
        </div>

        <div class="help">
          üì± –ù–∞—Ä–∞—á–∫–∞ = WhatsApp –ø–æ—Ä–∞–∫–∞ (–ø—Ä–æ–¥—É–∫—Ç + —Ü–µ–Ω–∞ + –≤–µ–ª–∏—á–∏–Ω–∞ + –∫–æ–ª–∏—á–∏–Ω–∞) ‚Ä¢ üß† –ü–æ–¥–∞—Ç–æ—Ü–∏ –ª–æ–∫–∞–ª–Ω–æ (localStorage) ‚Äî –æ—Å—Ç–∞–Ω—É–≤–∞–∞—Ç –Ω–∞ –∏—Å—Ç–∏–æ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω/PC.
        </div>

        <div class="divider"></div>

        <div class="grid" id="grid"></div>
      </div>
    </div>
  </div>

  <!-- MODAL: Categories -->
  <div class="modal" id="modalCats">
    <div class="modal-card">
      <div class="modal-head">
        <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
        <button class="btn" onclick="UI.close('modalCats')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body">
        <div id="catsList"></div>
        <div class="divider"></div>
        <div style="display:flex;flex-direction:column;gap:10px;">
          <!-- –û–≤–¥–µ –≥–æ —Ç—Ä–≥–Ω–∞–≤–º–µ ‚Äú+ –ü—Ä–æ–¥—É–∫—Ç‚Äù –æ–¥ –æ–±–∏—á–µ–Ω –ø—Ä–∏–∫–∞–∑ -->
          <button class="btn" onclick="UI.open('modalAdmin')">üîê Admin</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Order -->
  <div class="modal" id="modalOrder">
    <div class="modal-card">
      <div class="modal-head">
        <h3>–ù–∞—Ä–∞—á–∫–∞</h3>
        <button class="btn" onclick="UI.close('modalOrder')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body">
        <div class="row" style="gap:12px;align-items:flex-start">
          <img id="oImg" alt="" style="width:120px;height:90px;object-fit:cover;border-radius:16px;border:1px solid var(--line);background:rgba(255,255,255,.03)" />
          <div style="flex:1;min-width:220px">
            <div id="oTitle" style="font-weight:900;font-size:18px"></div>
            <div class="muted" id="oCat"></div>
            <div style="margin-top:6px;font-weight:1000;font-size:26px;color:var(--accent)" id="oPrice"></div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <div class="field">
            <label>–í–µ–ª–∏—á–∏–Ω–∞</label>
            <select id="oSize"></select>
            <div class="help" id="oAvail"></div>
          </div>
          <div class="field">
            <label>–ö–æ–ª–∏—á–∏–Ω–∞</label>
            <select id="oQty"></select>
            <div class="help">–å–µ —Å–µ –¥–æ–∑–≤–æ–ª–∏ —Å–∞–º–æ –∫–æ–ª–∏—á–∏–Ω–∞ —à—Ç–æ –µ –Ω–∞ –∑–∞–ª–∏—Ö–∞.</div>
          </div>
        </div>

        <div class="divider"></div>

        <button class="btn primary cta order" id="btnConfirm">
          ‚úÖ –ü–æ—Ç–≤—Ä–¥–∏ –∏ –æ—Ç–≤–æ—Ä–∏ WhatsApp
        </button>

        <div class="help" style="margin-top:10px">
          –ê–∫–æ WhatsApp –Ω–µ —Å–µ –æ—Ç–≤–æ—Ä–∏ –≤–µ–¥–Ω–∞—à –Ω–∞ iPhone: –ø—Ä–æ–±–∞—ò –ø–æ–≤—Ç–æ—Ä–Ω–æ (Safari –ø–æ–Ω–µ–∫–æ–≥–∞—à –±–ª–æ–∫–∏—Ä–∞ popup, –∑–∞—Ç–æ–∞ –∫–æ—Ä–∏—Å—Ç–∏–º–µ –¥–∏—Ä–µ–∫—Ç–µ–Ω redirect).
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Details -->
  <div class="modal" id="modalDetails">
    <div class="modal-card">
      <div class="modal-head">
        <h3>–î–µ—Ç–∞–ª–∏</h3>
        <button class="btn" onclick="UI.close('modalDetails')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body">
        <div id="dBody"></div>
      </div>
    </div>
  </div>

  <!-- MODAL: Admin -->
  <div class="modal" id="modalAdmin">
    <div class="modal-card">
      <div class="modal-head">
        <h3>Admin</h3>
        <button class="btn" onclick="UI.close('modalAdmin')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body">
        <div id="adminState"></div>

        <div class="divider"></div>

        <div class="row">
          <div class="field">
            <label>Admin –ª–æ–∑–∏–Ω–∫–∞ (—Ç–∏ —ò–∞ –±–∏—Ä–∞—à)</label>
            <input id="adminPass" type="password" placeholder="–í–Ω–µ—Å–∏ –ª–æ–∑–∏–Ω–∫–∞..." />
            <div class="help">–å–µ —Å–µ —á—É–≤–∞ –ª–æ–∫–∞–ª–Ω–æ –Ω–∞ —É—Ä–µ–¥–æ—Ç (localStorage).</div>
          </div>
          <div class="field" style="min-width:260px">
            <label>&nbsp;</label>
            <button class="btn primary" id="btnLogin">–ù–∞—ò–∞–≤–∏ —Å–µ / –ü–æ—Å—Ç–∞–≤–∏ –ª–æ–∑–∏–Ω–∫–∞</button>
            <div style="height:8px"></div>
            <button class="btn danger" id="btnLogout">–û–¥—ò–∞–≤–∏ —Å–µ</button>
          </div>
        </div>

        <div class="divider"></div>

        <div class="row" style="align-items:flex-end">
          <div class="field">
            <label>WhatsApp –±—Ä–æ—ò (–±–µ–∑ +)</label>
            <input id="waPhoneInput" type="text" placeholder="3897..." />
            <div class="help">–ü—Ä–∏–º–µ—Ä: 38972912601</div>
          </div>
          <div class="field" style="min-width:260px">
            <label>&nbsp;</label>
            <button class="btn" id="btnSaveConfig">–ó–∞—á—É–≤–∞—ò</button>
          </div>
        </div>

        <div class="divider"></div>

        <div class="help">–ö–æ–≥–∞ —Å–∏ Admin —ú–µ —Å–µ –ø–æ—ò–∞–≤–∏ –∫–æ–ø—á–µ ‚Äú+ –ü—Ä–æ–¥—É–∫—Ç‚Äù –≥–æ—Ä–µ –¥–µ—Å–Ω–æ.</div>
      </div>
    </div>
  </div>

  <!-- MODAL: Add product -->
  <div class="modal" id="modalAdd">
    <div class="modal-card">
      <div class="modal-head">
        <h3>–î–æ–¥–∞—ò –ø—Ä–æ–¥—É–∫—Ç</h3>
        <button class="btn" onclick="UI.close('modalAdd')">–ó–∞—Ç–≤–æ—Ä–∏</button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="field">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞</label>
            <select id="aCat"></select>
          </div>
          <div class="field">
            <label>–ò–º–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç</label>
            <input id="aName" type="text" placeholder="–ü—Ä–∏–º–µ—Ä: –¢—Ä–µ–Ω–µ—Ä–∫–∏ #1" />
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>–¶–µ–Ω–∞ (–¥–µ–Ω)</label>
            <input id="aPrice" type="number" min="0" step="1" placeholder="5590" />
          </div>
          <div class="field">
            <label>–°–ª–∏–∫–∏ (–¥–æ 5 –æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω)</label>
<input id="aImgsUpload" type="file" accept="image/*" multiple>
<div class="help">–ò–∑–±–µ—Ä–∏ –¥–æ 5 —Å–ª–∏–∫–∏ –æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ –∫–∞–º–µ—Ä–∞.</div>
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>–û–ø–∏—Å</label>
            <textarea id="aDesc" placeholder="–ú–∞—Ç–µ—Ä–∏—ò–∞–ª, –¥–µ—Ç–∞–ª–∏, –º–µ—Ä–∫–∏..."></textarea>
          </div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <div class="field">
            <label>–ó–∞–ª–∏—Ö–∞ (–æ–±–ª–µ–∫–∞: S‚Äì3XL)</label>
            <input id="aStockClothes" type="text" placeholder="S=2,M=5,L=3,XL=1,2XL=0,3XL=0" />
            <div class="help">–ê–∫–æ –µ –∫–∞—Ç–µ–≥–æ—Ä–∏—ò–∞ —Ñ–∞—Ä–º–µ—Ä–∫–∏/–ø–∞–Ω—Ç–∞–ª–æ–Ω–∏, –∫–æ—Ä–∏—Å—Ç–∏ –¥–æ–ª—É.</div>
          </div>
          <div class="field">
            <label>–ó–∞–ª–∏—Ö–∞ (—Ñ–∞—Ä–º–µ—Ä–∫–∏/–ø–∞–Ω—Ç–∞–ª–æ–Ω–∏: 30‚Äì42)</label>
            <input id="aStockJeans" type="text" placeholder="30=2,31=1,32=0,33=4,34=2,36=1,38=0,40=0,42=0" />
          </div>
        </div>

        <div class="divider"></div>

        <button class="btn primary cta" id="btnAddSave">‚úÖ –ó–∞—á—É–≤–∞—ò –ø—Ä–æ–¥—É–∫—Ç</button>
        <div class="help">–ü–æ—Ç–æ–∞ –ø—Ä–æ–¥—É–∫—Ç–æ—Ç —ú–µ —Å–µ –ø–æ—ò–∞–≤–∏ –≤–µ–¥–Ω–∞—à –Ω–∞ –ª–∏—Å—Ç–∞—Ç–∞ (–Ω–∞ –∏—Å—Ç–∏–æ—Ç —É—Ä–µ–¥).</div>
      </div>
    </div>
  </div>

  <script>
    /* =========================
       CONFIG
    ========================== */
    const LS_KEY = "mertax_butik_v4";
    const LS_ADMIN = "mertax_admin_v4";
    const LS_PASS = "mertax_pass_v4";
    const LS_CFG  = "mertax_cfg_v4";

    const DEFAULT_CFG = {
      wa_phone: "38972912601" // —Ç–≤–æ—ò –±—Ä–æ—ò (–±–µ–∑ +)
    };

    /* =========================
       DATA
    ========================== */
    const SIZES_CLOTHES = ["S","M","L","XL","2XL","3XL"];
    const SIZES_JEANS   = ["30","31","32","33","34","36","38","40","42"];

    const CATS = [
      { id:"cemperi", name:"–è–µ–º–ø–µ—Ä–∏", sizeMode:"clothes", target:150 },
      { id:"maicki", name:"–ú–∞–∏—Ü–∏", sizeMode:"clothes", target:150 },
      { id:"trenerki", name:"–ö–æ—à—É–ª–∏", sizeMode:"clothes", target:70 },
      { id:"jakni", name:"–ë–ª—É–∑–æ–Ω–∏", sizeMode:"clothes", target:70 },
      { id:"odela", name:"–û–¥–µ–ª–∞", sizeMode:"clothes", target:70 },
      { id:"bluzoni", name:"–à–∞–∫–Ω–∏", sizeMode:"clothes", target:150 },
      { id:"farmerki", name:"–§–∞—Ä–º–µ—Ä–∫–∏/–ü–∞–Ω—Ç–∞–ª–æ–Ω–∏", sizeMode:"jeans", target:150 },
      { id:"patiki", name:"–¢—Ä–µ–Ω–µ—Ä–∫–∏", sizeMode:"clothes", target:150 }
    ];

    const DEMO_IMAGES = [
      "https://images.unsplash.com/photo-1520975682031-a7b67de4d0f8?auto=format&fit=crop&w=1600&q=60",
      "https://images.unsplash.com/photo-1520975916090-3105956dac38?auto=format&fit=crop&w=1600&q=60",
      "https://images.unsplash.com/photo-1520975958227-69b44cf0c447?auto=format&fit=crop&w=1600&q=60",
      "https://images.unsplash.com/photo-1520975915612-23f4b2f1c2db?auto=format&fit=crop&w=1600&q=60",
      "https://images.unsplash.com/photo-1520975915851-21cfb0c4b6e7?auto=format&fit=crop&w=1600&q=60"
    ];

    /* =========================
       STATE
    ========================== */
    const state = {
      cfg: loadCfg(),
      admin: isAdmin(),
      cat: "",
      q: "",
      sizeFilter: "",
      products: loadProducts()
    };

    /* =========================
       UI HELPERS
    ========================== */
    const UI = {
      open(id){ document.getElementById(id).classList.add("show"); },
      close(id){ document.getElementById(id).classList.remove("show"); },
      toast(msg){
        alert(msg);
      }
    };

    function money(n){
      const x = Number(n||0);
      return x.toLocaleString("mk-MK") + " –¥–µ–Ω";
    }

    function uid(){
      return Math.random().toString(36).slice(2) + Date.now().toString(36);
    }

    function escapeHtml(s){
      return String(s||"")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function pickCover(imgs){
      const arr = Array.isArray(imgs) ? imgs.filter(Boolean) : [];
      if(arr.length) return arr[0];
      return DEMO_IMAGES[Math.floor(Math.random()*DEMO_IMAGES.length)];
    }

    function catById(id){ return CATS.find(c=>c.id===id) || CATS[0]; }

    function parseStock(str){
      // "S=2,M=5,L=0"
      const out = {};
      String(str||"").split(",").map(x=>x.trim()).filter(Boolean).forEach(p=>{
        const [k,v] = p.split("=").map(x=>x.trim());
        if(!k) return;
        out[k] = Math.max(0, Number(v||0));
      });
      return out;
    }

    function normalizeStock(sizeMode, stockObj){
      const sizes = sizeMode==="jeans" ? SIZES_JEANS : SIZES_CLOTHES;
      const s = {};
      sizes.forEach(sz => s[sz] = Math.max(0, Number(stockObj?.[sz]||0)));
      return s;
    }

    function totalAvailable(p){
      return Object.values(p.stock||{}).reduce((a,b)=>a+Number(b||0),0);
    }

    function availableSizes(p){
      return Object.entries(p.stock||{}).filter(([k,v])=>Number(v||0)>0).map(([k])=>k);
    }

    /* =========================
       STORAGE
    ========================== */
    function loadCfg(){
      try{
        const c = JSON.parse(localStorage.getItem(LS_CFG) || "null");
        return {...DEFAULT_CFG, ...(c||{})};
      }catch(e){
        return {...DEFAULT_CFG};
      }
    }
    function saveCfg(cfg){
      localStorage.setItem(LS_CFG, JSON.stringify(cfg));
    }

    function loadProducts(){
      try{
        const x = JSON.parse(localStorage.getItem(LS_KEY) || "null");
        if(Array.isArray(x) && x.length) return x;
      }catch(e){}
      // seed demo (–º–∞–ª–∫—É, –ø–∞ —Ç–∏ –¥–æ–¥–∞–≤–∞—à –ø—Ä–µ–∫—É Admin)
      const demo = [];
      let i=1;
      ["patiki","farmerki","trenerki","maicki","jakni"].forEach(cat=>{
        const sizeMode = catById(cat).sizeMode;
        for(let k=0;k<6;k++){
          const stock = {};
          const sizes = sizeMode==="jeans" ? SIZES_JEANS : SIZES_CLOTHES;
          sizes.forEach(sz => stock[sz] = Math.floor(Math.random()*4));
          demo.push({
            id: uid(),
            cat,
            name: `${catById(cat).name} #${i++}`,
            price: Math.floor(1200 + Math.random()*6000),
            imgs: [pickCover([])],
            desc: "–î–µ–º–æ –æ–ø–∏—Å. –î–æ–¥–∞—ò —Å–≤–æ—ò –æ–ø–∏—Å –≤–æ Admin.",
            stock: normalizeStock(sizeMode, stock)
          });
        }
      });
      localStorage.setItem(LS_KEY, JSON.stringify(demo));
      return demo;
    }

    function saveProducts(){
      localStorage.setItem(LS_KEY, JSON.stringify(state.products));
    }

    function isAdmin(){
      return localStorage.getItem(LS_ADMIN)==="1";
    }
    function setAdmin(val){
      localStorage.setItem(LS_ADMIN, val ? "1":"0");
      state.admin = val;
      syncAdminUI();
    }

    /* =========================
       RENDER
    ========================== */
    function renderCats(){
      const wrap = document.getElementById("catsList");
      wrap.innerHTML = "";
      const list = document.createElement("div");
      list.style.display="grid";
      list.style.gridTemplateColumns="repeat(2,1fr)";
      list.style.gap="10px";
      if(window.innerWidth<560) list.style.gridTemplateColumns="1fr";

      const mkBtn = (txt, onClick) => {
        const b = document.createElement("button");
        b.className = "btn";
        b.textContent = txt;
        b.onclick = onClick;
        return b;
      };

      list.appendChild(mkBtn("–°–∏—Ç–µ", ()=>{
        state.cat="";
        UI.close("modalCats");
        renderAll();
      }));

      CATS.forEach(c=>{
        list.appendChild(mkBtn(c.name, ()=>{
          state.cat=c.id;
          UI.close("modalCats");
          renderAll();
        }));
      });

      wrap.appendChild(list);

      // fill category select too
      const sel = document.getElementById("catSel");
      const aSel = document.getElementById("aCat");
      sel.innerHTML = "";
      aSel.innerHTML = "";

      const optAll = new Option("–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞: (—Å–∏—Ç–µ)", "");
      sel.add(optAll);

      CATS.forEach(c=>{
        sel.add(new Option(c.name, c.id));
        aSel.add(new Option(c.name, c.id));
      });

      sel.value = state.cat;
    }

    function renderSizeFilter(){
      const sf = document.getElementById("sizeFilter");
      const sizes = new Set();

      // —Å–∞–º–æ –¥–æ—Å—Ç–∞–ø–Ω–∏ –≥–æ–ª–µ–º–∏–Ω–∏ –æ–¥ –º–æ–º–µ–Ω—Ç–∞–ª–Ω–∏—Ç–µ —Ñ–∏–ª—Ç—Ä–∏
      getFilteredProducts(false).forEach(p=>{
        availableSizes(p).forEach(s=>sizes.add(s));
      });

      const cur = sf.value;
      sf.innerHTML = `<option value="">–§–∏–ª—Ç–µ—Ä –ø–æ –≤–µ–ª–∏—á–∏–Ω–∞ (—Å–∞–º–æ –¥–æ—Å—Ç–∞–ø–Ω–∏)</option>`;
      [...sizes].sort((a,b)=> {
        // numbers first
        const na = Number(a), nb = Number(b);
        const isNumA = !Number.isNaN(na), isNumB = !Number.isNaN(nb);
        if(isNumA && isNumB) return na-nb;
        if(isNumA) return -1;
        if(isNumB) return 1;
        return a.localeCompare(b);
      }).forEach(s=>{
        sf.add(new Option(s, s));
      });

      sf.value = state.sizeFilter || "";
      if(cur && sf.value!==cur) { /* ignore */ }
    }

    function getFilteredProducts(applySizeFilter=true){
      const q = (state.q||"").trim().toLowerCase();
      const cat = state.cat;
      const sf = applySizeFilter ? (state.sizeFilter||"") : "";
      return state.products.filter(p=>{
        if(cat && p.cat!==cat) return false;
        if(q){
          const hay = `${p.name} ${catById(p.cat).name} ${p.desc||""}`.toLowerCase();
          if(!hay.includes(q)) return false;
        }
        if(sf){
          return Number(p.stock?.[sf]||0) > 0;
        }
        return true;
      });
    }

    function renderGrid(){
      const grid = document.getElementById("grid");
      grid.innerHTML = "";

      const list = getFilteredProducts(true);
      document.getElementById("countInfo").textContent = `${list.length} –ø—Ä–æ–¥—É–∫—Ç–∏`;

      const catName = state.cat ? catById(state.cat).name : "(—Å–∏—Ç–µ)";
      const chip = document.getElementById("chipInfo");
      chip.textContent = `–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞: ${catName} ‚Ä¢ –§–∏–ª—Ç–µ—Ä: ${state.sizeFilter ? state.sizeFilter : "–¥–æ—Å—Ç–∞–ø–Ω–∏"}`;

      list.forEach(p=>{
        const card = document.createElement("div");
        card.className="card";

        const cover = pickCover(p.imgs);

        const img = document.createElement("div");
        img.className="imgwrap";
        img.innerHTML = `
          <img src="${escapeHtml(cover)}" alt="">
          <div class="badge">${escapeHtml(catById(p.cat).name)}</div>
        `;

        const body = document.createElement("div");
        body.className="cardbody";

        const sizes = Object.entries(p.stock||{});
        const sizesHtml = sizes.slice(0, 10).map(([k,v])=>{
          const ok = Number(v||0)>0;
          return `<span class="sz"><span class="dot ${ok?'ok':'no'}"></span>${escapeHtml(k)} <span class="muted">(${Number(v||0)})</span></span>`;
        }).join("");

        const allAvail = totalAvailable(p);

        const btnOrderDisabled = allAvail<=0;

        body.innerHTML = `
          <div class="pname">${escapeHtml(p.name)}</div>
          <div class="price">${money(p.price)}</div>
          <div class="meta">
            <div>–î–æ—Å—Ç–∞–ø–Ω–æ: <b>${allAvail}</b></div>
            <div>${catById(p.cat).sizeMode==="jeans" ? "30‚Äì42" : "S‚Äì3XL"}</div>
          </div>
          <div class="sizes">${sizesHtml}</div>

          <div class="cardbtns">
            <button class="btn cta order ${btnOrderDisabled?'':'primary'}" ${btnOrderDisabled?'disabled':''}>–ù–∞—Ä–∞—á–∞—ò</button>
            <button class="btn cta details">–î–µ—Ç–∞–ª–∏</button>
          </div>
        `;

        const [bOrder, bDet] = body.querySelectorAll("button");
        bOrder.onclick = ()=> openOrder(p.id);
        bDet.onclick = ()=> openDetails(p.id);

        card.appendChild(img);
        card.appendChild(body);
        grid.appendChild(card);
      });
    }

    function renderAll(){
      document.getElementById("catSel").value = state.cat;
      document.getElementById("q").value = state.q;
      document.getElementById("qTop").value = state.q;
      renderCats();
      renderSizeFilter();
      renderGrid();
      syncAdminUI();
    }

    function syncAdminUI(){
      const addBtn = document.getElementById("btnAdd");
      addBtn.style.display = state.admin ? "" : "none";

      const a = document.getElementById("adminState");
      a.innerHTML = state.admin
        ? `<span class="mini">‚úÖ –ù–∞—ò–∞–≤–µ–Ω —Å–∏ –∫–∞–∫–æ Admin</span>`
        : `<span class="mini">üîí –ù–µ —Å–∏ –Ω–∞—ò–∞–≤–µ–Ω</span>`;

      document.getElementById("waPhoneInput").value = state.cfg.wa_phone || DEFAULT_CFG.wa_phone;
    }

    /* =========================
       DETAILS + ORDER
    ========================== */
    let orderPid = null;

    function openDetails(pid){
      const p = state.products.find(x=>x.id===pid);
      if(!p) return;
      const cat = catById(p.cat);

      const imgs = (p.imgs && p.imgs.length ? p.imgs : [pickCover([])]).slice(0,5);
      const gallery = imgs.map(u=>`<img src="${escapeHtml(u)}" style="width:100%;max-height:240px;object-fit:cover;border-radius:18px;border:1px solid var(--line);background:rgba(255,255,255,.03);margin-bottom:10px" />`).join("");

      const stockRows = Object.entries(p.stock||{}).map(([k,v])=>{
        const ok = Number(v||0)>0;
        return `<div class="sz" style="justify-content:space-between;min-width:120px">
          <span><span class="dot ${ok?'ok':'no'}"></span> ${escapeHtml(k)}</span>
          <b>${Number(v||0)}</b>
        </div>`;
      }).join("");

      document.getElementById("dBody").innerHTML = `
        <div style="display:grid;grid-template-columns:1fr;gap:12px">
          <div>${gallery}</div>
          <div style="border:1px solid var(--line);background:rgba(255,255,255,.04);border-radius:18px;padding:12px">
            <div style="font-weight:1000;font-size:22px">${escapeHtml(p.name)}</div>
            <div class="muted">${escapeHtml(cat.name)}</div>
            <div style="margin-top:8px;font-weight:1000;font-size:30px;color:var(--accent)">${money(p.price)}</div>
            <div class="divider"></div>
            <div style="white-space:pre-wrap;color:var(--muted)">${escapeHtml(p.desc||"")}</div>
            <div class="divider"></div>
            <div style="font-weight:900;margin-bottom:8px">–ó–∞–ª–∏—Ö–∞ –ø–æ –≤–µ–ª–∏—á–∏–Ω–∞</div>
            <div style="display:flex;gap:8px;flex-wrap:wrap">${stockRows}</div>
          </div>
        </div>
      `;
      UI.open("modalDetails");
    }

    function openOrder(pid){
      const p = state.products.find(x=>x.id===pid);
      if(!p) return;

      orderPid = pid;

      const cover = pickCover(p.imgs);
      document.getElementById("oImg").src = cover;
      document.getElementById("oTitle").textContent = p.name;
      document.getElementById("oCat").textContent = catById(p.cat).name;
      document.getElementById("oPrice").textContent = money(p.price);

      const sizes = Object.entries(p.stock||{}).filter(([k,v])=>Number(v||0)>0);
      const sel = document.getElementById("oSize");
      sel.innerHTML = "";
      sizes.forEach(([k,v])=>{
        sel.add(new Option(`${k} (${v})`, k));
      });

      if(!sizes.length){
        UI.toast("–ù–µ–º–∞ –∑–∞–ª–∏—Ö–∞ –∑–∞ –æ–≤–æ—ò –ø—Ä–æ–¥—É–∫—Ç.");
        return;
      }

      sel.onchange = ()=> updateQtyOptions();
      updateQtyOptions();

      document.getElementById("btnConfirm").onclick = ()=> confirmOrder();

      UI.open("modalOrder");
    }

    function updateQtyOptions(){
      const p = state.products.find(x=>x.id===orderPid);
      if(!p) return;
      const size = document.getElementById("oSize").value;
      const avail = Number(p.stock?.[size]||0);

      document.getElementById("oAvail").textContent = `–î–æ—Å—Ç–∞–ø–Ω–æ –∑–∞ ${size}: ${avail}`;

      const qSel = document.getElementById("oQty");
      qSel.innerHTML = "";
      for(let i=1;i<=Math.max(1,avail);i++){
        qSel.add(new Option(String(i), String(i)));
      }
    }

    function buildWhatsAppText(p, size, qty){
      const cat = catById(p.cat).name;
      const lines = [
        "–ó–¥—Ä–∞–≤–æ, —Å–∞–∫–∞–º –¥–∞ –Ω–∞—Ä–∞—á–∞–º:",
        `‚Ä¢ –ü—Ä–æ–¥—É–∫—Ç: ${p.name}`,
        `‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞: ${cat}`,
        `‚Ä¢ –¶–µ–Ω–∞: ${money(p.price)}`,
        `‚Ä¢ –í–µ–ª–∏—á–∏–Ω–∞: ${size}`,
        `‚Ä¢ –ö–æ–ª–∏—á–∏–Ω–∞: ${qty}`,
        "",
        "–í–µ –º–æ–ª–∞–º –ø–æ—Ç–≤—Ä–¥–µ—Ç–µ –¥–æ—Å—Ç–∞–ø–Ω–æ—Å—Ç. –ë–ª–∞–≥–æ–¥–∞—Ä–∞–º!"
      ];
      return lines.join("\n");
    }

    function openWhatsApp(phone, text){
      // –ù–∞ iPhone/Safari –Ω–∞—ò—Å–∏–≥—É—Ä–Ω–æ –µ redirect (–Ω–µ popup)
      // 1) –ø—Ä–æ–±–∞—ò whatsapp://
      // 2) fallback –Ω–∞ https://wa.me/
      const waDeep = `whatsapp://send?phone=${phone}&text=${encodeURIComponent(text)}`;
      const waWeb  = `https://wa.me/${phone}?text=${encodeURIComponent(text)}`;

      // –æ–±–∏–¥ —Å–æ deep link
      window.location.href = waDeep;

      // fallback –ø–æ—Å–ª–µ –º–∞–ª–∫—É
      setTimeout(()=>{ window.location.href = waWeb; }, 700);
    }

    function confirmOrder(){
      const p = state.products.find(x=>x.id===orderPid);
      if(!p) return;

      const size = document.getElementById("oSize").value;
      const qty = Number(document.getElementById("oQty").value||1);

      const avail = Number(p.stock?.[size]||0);
      if(qty>avail){
        UI.toast("–ù–µ–º–∞ –¥–æ–≤–æ–ª–Ω–æ –∑–∞–ª–∏—Ö–∞ –∑–∞ –∏–∑–±—Ä–∞–Ω–∞—Ç–∞ –∫–æ–ª–∏—á–∏–Ω–∞.");
        return;
      }

      // –Ω–∞–º–∞–ª–∏ –∑–∞–ª–∏—Ö–∞
      p.stock[size] = avail - qty;
      saveProducts();
      renderAll();
      UI.close("modalOrder");

      const text = buildWhatsAppText(p, size, qty);
      const phone = String(state.cfg.wa_phone||DEFAULT_CFG.wa_phone).replace(/\D/g,"");

      openWhatsApp(phone, text);
    }

    /* =========================
       ADMIN
    ========================== */
    function openAddModal(){
      if(!state.admin){
        UI.toast("–°–∞–º–æ Admin –º–æ–∂–µ –¥–∞ –¥–æ–¥–∞–≤–∞ –ø—Ä–æ–¥—É–∫—Ç–∏.");
        return;
      }
      document.getElementById("aCat").value = state.cat || CATS[0].id;
      document.getElementById("aName").value = "";
      document.getElementById("aPrice").value = "";
      document.getElementById("aImgs").value = "";
      document.getElementById("aDesc").value = "";
      document.getElementById("aStockClothes").value = "";
      document.getElementById("aStockJeans").value = "";
      UI.open("modalAdd");
    }

    function saveNewProduct(){
      if(!state.admin) return;

      const cat = document.getElementById("aCat").value;
      const name = document.getElementById("aName").value.trim();
      const price = Number(document.getElementById("aPrice").value||0);
      const c = catById(cat);
const fileInput = document.getElementById("aImgsUpload");
const files = Array.from(fileInput.files).slice(0,5);

if(files.length === 0){
  UI.toast("–ò–∑–±–µ—Ä–∏ –±–∞—Ä–µ–º –µ–¥–Ω–∞ —Å–ª–∏–∫–∞.");
  return;
}

const readFile = (file) => {
  return new Promise((resolve)=>{
    const reader = new FileReader();
    reader.onload = e => resolve(e.target.result);
    reader.readAsDataURL(file);
  });
};

Promise.all(files.map(f => readFile(f))).then(results => {

  const imgs = results;

  const stockC = parseStock(document.getElementById("aStockClothes").value);
  const stockJ = parseStock(document.getElementById("aStockJeans").value);

  const stock = c.sizeMode==="jeans"
    ? normalizeStock("jeans", stockJ)
    : normalizeStock("clothes", stockC);

  const p = {
    id: uid(),
    cat,
    name,
    price,
    imgs,
    desc,
    stock
  };

  state.products.unshift(p);
  saveProducts();
  UI.close("modalAdd");
  renderAll();
});

return;
      if(!cat || !name || price<=0){
        UI.toast("–í–Ω–µ—Å–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—ò–∞, –∏–º–µ –∏ —Ü–µ–Ω–∞.");
        return;
      }

      const c = catById(cat);
      const imgs = imgsRaw
        ? imgsRaw.split(",").map(x=>x.trim()).filter(Boolean).slice(0,5)
        : [pickCover([])];

      const stockC = parseStock(document.getElementById("aStockClothes").value);
      const stockJ = parseStock(document.getElementById("aStockJeans").value);

      const stock = c.sizeMode==="jeans"
        ? normalizeStock("jeans", stockJ)
        : normalizeStock("clothes", stockC);

      const p = {
        id: uid(),
        cat,
        name,
        price,
        imgs,
        desc,
        stock
      };

      state.products.unshift(p);
      saveProducts();
      UI.close("modalAdd");
      renderAll();
    }

    function adminLoginOrSet(){
      const pass = document.getElementById("adminPass").value;
      if(!pass){ UI.toast("–í–Ω–µ—Å–∏ –ª–æ–∑–∏–Ω–∫–∞."); return; }

      const saved = localStorage.getItem(LS_PASS);
      if(!saved){
        localStorage.setItem(LS_PASS, pass);
        setAdmin(true);
        UI.toast("–ü–æ—Å—Ç–∞–≤–µ–Ω–∞ –ª–æ–∑–∏–Ω–∫–∞ –∏ –Ω–∞—ò–∞–≤–µ–Ω —Å–∏.");
        return;
      }
      if(saved === pass){
        setAdmin(true);
        UI.toast("–£—Å–ø–µ—à–Ω–∞ –Ω–∞—ò–∞–≤–∞.");
      }else{
        UI.toast("–ü–æ–≥—Ä–µ—à–Ω–∞ –ª–æ–∑–∏–Ω–∫–∞.");
      }
    }

    function adminLogout(){
      setAdmin(false);
      UI.toast("–û–¥—ò–∞–≤–µ–Ω.");
    }

    function saveConfig(){
      if(!state.admin){
        UI.toast("–°–∞–º–æ Admin –º–æ–∂–µ –¥–∞ –º–µ–Ω—É–≤–∞ –±—Ä–æ—ò.");
        return;
      }
      const v = document.getElementById("waPhoneInput").value.trim().replace(/\D/g,"");
      if(!v || v.length<8){
        UI.toast("–í–Ω–µ—Å–∏ –≤–∞–ª–∏–¥–µ–Ω WhatsApp –±—Ä–æ—ò.");
        return;
      }
      state.cfg.wa_phone = v;
      saveCfg(state.cfg);
      UI.toast("–ó–∞—á—É–≤–∞–Ω–æ.");
    }

    /* =========================
       EVENTS
    ========================== */
    document.getElementById("btnCats").onclick = ()=> UI.open("modalCats");
    document.getElementById("brandClick").onclick = ()=>{
      state.cat="";
      state.q="";
      state.sizeFilter="";
      renderAll();
      window.scrollTo({top:0, behavior:"smooth"});
    };

    document.getElementById("q").addEventListener("input", (e)=>{
      state.q = e.target.value;
      renderAll();
    });
    document.getElementById("qTop").addEventListener("input", (e)=>{
      state.q = e.target.value;
      renderAll();
    });

    document.getElementById("catSel").onchange = (e)=>{
      state.cat = e.target.value;
      renderAll();
    };

    document.getElementById("sizeFilter").onchange = (e)=>{
      state.sizeFilter = e.target.value;
      renderAll();
    };

    document.getElementById("btnReset").onclick = ()=>{
      state.cat="";
      state.q="";
      state.sizeFilter="";
      renderAll();
    };

    document.getElementById("btnAdmin").onclick = ()=> UI.open("modalAdmin");
    document.getElementById("btnAdd").onclick = ()=> openAddModal();
    document.getElementById("btnAddSave").onclick = ()=> saveNewProduct();

    document.getElementById("btnLogin").onclick = ()=> adminLoginOrSet();
    document.getElementById("btnLogout").onclick = ()=> adminLogout();
    document.getElementById("btnSaveConfig").onclick = ()=> saveConfig();

    // close modal on background click
    ["modalCats","modalOrder","modalAdd","modalAdmin","modalDetails"].forEach(id=>{
      const m = document.getElementById(id);
      m.addEventListener("click", (e)=>{
        if(e.target===m) UI.close(id);
      });
    });

    /* =========================
       INIT
    ========================== */
    renderAll();
  </script>
</body>
</html>

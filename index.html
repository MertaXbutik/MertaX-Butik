<!doctype html>
<html lang="mk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MertaX Butik</title>
  <style>
    :root { --bg:#0b0b0b; --card:#121212; --muted:#bdbdbd; --txt:#fff; --accent:#22c55e; --danger:#ef4444; }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family:Arial, sans-serif; background:#0f0f10; color:var(--txt); }
    header{ background:#000; color:#fff; padding:16px 14px; text-align:center; font-size:22px; letter-spacing:1px; position:sticky; top:0; z-index:5; }
    .wrap{ max-width:1100px; margin:0 auto; padding:14px; }
    .topbar{ display:flex; gap:10px; align-items:center; justify-content:space-between; margin:10px 0 14px; }
    .badge{ background:#1f1f1f; padding:8px 10px; border-radius:10px; color:#fff; display:flex; align-items:center; gap:8px; }
    .btn{ border:0; cursor:pointer; padding:10px 12px; border-radius:10px; font-weight:700; }
    .btn-accent{ background:var(--accent); color:#041a0b; }
    .btn-danger{ background:var(--danger); color:#fff; }
    .btn-dark{ background:#1f1f1f; color:#fff; }
    .grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:12px; }
    @media (min-width:820px){ .grid{ grid-template-columns:repeat(4,1fr); } }
    .card{ background:var(--card); border-radius:14px; overflow:hidden; border:1px solid #1f1f1f; }
    .img{ width:100%; aspect-ratio: 1/1; object-fit:cover; background:#222; display:block; }
    .p{ padding:10px; }
    .name{ font-weight:800; margin:0 0 6px; font-size:14px; }
    .price{ color:var(--muted); margin:0 0 10px; font-size:13px; }
    .row{ display:flex; gap:8px; align-items:center; justify-content:space-between; }
    .small{ font-size:12px; color:var(--muted); }
    /* Cart drawer */
    .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; z-index:9; }
    .drawer{ position:fixed; right:0; top:0; height:100%; width:min(420px, 92vw); background:#0e0e0f; border-left:1px solid #1f1f1f;
      transform:translateX(110%); transition:.25s; z-index:10; display:flex; flex-direction:column; }
    .drawer.open{ transform:translateX(0); }
    .overlay.show{ display:block; }
    .drawer h2{ margin:0; padding:14px; border-bottom:1px solid #1f1f1f; font-size:18px; }
    .cartlist{ padding:10px 14px; overflow:auto; flex:1; }
    .item{ display:flex; gap:10px; padding:10px 0; border-bottom:1px solid #1a1a1a; }
    .thumb{ width:56px; height:56px; border-radius:10px; object-fit:cover; background:#222; }
    .itxt{ flex:1; }
    .itxt b{ display:block; font-size:13px; margin-bottom:4px; }
    .qty{ display:flex; gap:6px; align-items:center; }
    .qty button{ width:32px; height:32px; border-radius:10px; border:1px solid #2a2a2a; background:#151515; color:#fff; font-size:18px; cursor:pointer; }
    .foot{ padding:12px 14px; border-top:1px solid #1f1f1f; }
    .foot .line{ display:flex; justify-content:space-between; margin:8px 0; color:#ddd; }
    .foot .line b{ color:#fff; }
  </style>
</head>
<body>
  <header>MertaX Butik</header>

  <div class="wrap">
    <div class="topbar">
      <div class="badge">
        üõí –ö–æ—à–Ω–∏—á–∫–∞: <b id="cartCount">0</b>
        <span class="small">| –í–∫—É–ø–Ω–æ: <b id="cartTotal">0</b> –¥–µ–Ω.</span>
      </div>
      <div style="display:flex; gap:8px;">
        <button class="btn btn-dark" id="openCartBtn">–û—Ç–≤–æ—Ä–∏ –∫–æ—à–Ω–∏—á–∫–∞</button>
        <button class="btn btn-danger" id="clearCartBtn">–ò—Å–ø—Ä–∞–∑–Ω–∏</button>
      </div>
    </div>

    <div class="grid" id="productGrid"></div>
  </div>

  <!-- Cart drawer -->
  <div class="overlay" id="overlay"></div>
  <aside class="drawer" id="drawer">
    <h2>–¢–≤–æ—ò–∞ –∫–æ—à–Ω–∏—á–∫–∞</h2>
    <div class="cartlist" id="cartList"></div>
    <div class="foot">
      <div class="line"><span>–ü—Ä–æ–∏–∑–≤–æ–¥–∏</span> <b id="sumItems">0</b></div>
      <div class="line"><span>–í–∫—É–ø–Ω–æ</span> <b><span id="sumTotal">0</span> –¥–µ–Ω.</b></div>
      <button class="btn btn-accent" id="goCheckoutBtn" style="width:100%;">–ü—Ä–æ–¥–æ–ª–∂–∏ –Ω–∞ –Ω–∞—Ä–∞—á–∫–∞</button>
    </div>
  </aside>

  <script>
    // ‚úÖ –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–∏–∑–≤–æ–¥–∏ (–∑–∞–º–µ–Ω–∏ —Å–æ —Ç–≤–æ–∏—Ç–µ)
    const products = [
      { id:"p1", name:"MertaX –ü–∞—Ä–∏—á–Ω–∏–∫", price:790, img:"https://images.unsplash.com/photo-1523275335684-37898b6baf30?auto=format&fit=crop&w=900&q=60" },
      { id:"p2", name:"MertaX –ú–∞–∏—á–∫–∞", price:990, img:"https://images.unsplash.com/photo-1520975958225-6a97d5a0f98f?auto=format&fit=crop&w=900&q=60" },
      { id:"p3", name:"MertaX –ö–∞–ø—á–µ", price:590, img:"https://images.unsplash.com/photo-1523381294911-8d3cead13475?auto=format&fit=crop&w=900&q=60" },
      { id:"p4", name:"MertaX –ü–∞—Ç–∏–∫–∏", price:2990, img:"https://images.unsplash.com/photo-1542291026-7eec264c27ff?auto=format&fit=crop&w=900&q=60" },
    ];

    // ----- CART STORAGE -----
    const CART_KEY = "mertax_cart_v1";
    const loadCart = () => JSON.parse(localStorage.getItem(CART_KEY) || "[]");
    const saveCart = (cart) => localStorage.setItem(CART_KEY, JSON.stringify(cart));

    const findProduct = (id) => products.find(p => p.id === id);

    function cartTotals(cart){
      let items = 0, total = 0;
      for(const c of cart){
        items += c.qty;
        const p = findProduct(c.id);
        if(p) total += p.price * c.qty;
      }
      return { items, total };
    }

    function addToCart(id){
      const cart = loadCart();
      const item = cart.find(x => x.id === id);
      if(item) item.qty += 1;
      else cart.push({ id, qty:1 });
      saveCart(cart);
      renderCartUI();
    }

    function setQty(id, qty){
      const cart = loadCart().map(x => x.id === id ? ({...x, qty}) : x).filter(x => x.qty > 0);
      saveCart(cart);
      renderCartUI();
    }

    function clearCart(){
      saveCart([]);
      renderCartUI();
    }

    // ----- RENDER PRODUCTS -----
    const grid = document.getElementById("productGrid");
    function renderProducts(){
      grid.innerHTML = products.map(p => `
        <div class="card">
          <img class="img" src="${p.img}" alt="${p.name}">
          <div class="p">
            <p class="name">${p.name}</p>
            <p class="price">${p.price} –¥–µ–Ω.</p>
            <div class="row">
              <button class="btn btn-accent" onclick="addToCart('${p.id}')">–î–æ–¥–∞—ò</button>
              <span class="small">ID: ${p.id}</span>
            </div>
          </div>
        </div>
      `).join("");
    }

    // ----- CART DRAWER UI -----
    const cartCount = document.getElementById("cartCount");
    const cartTotal = document.getElementById("cartTotal");
    const cartList = document.getElementById("cartList");
    const sumItems = document.getElementById("sumItems");
    const sumTotal = document.getElementById("sumTotal");

    const overlay = document.getElementById("overlay");
    const drawer = document.getElementById("drawer");
    function openCart(){
      overlay.classList.add("show");
      drawer.classList.add("open");
    }
    function closeCart(){
      overlay.classList.remove("show");
      drawer.classList.remove("open");
    }

    function renderCartUI(){
      const cart = loadCart();
      const { items, total } = cartTotals(cart);

      cartCount.textContent = items;
      cartTotal.textContent = total;
      sumItems.textContent = items;
      sumTotal.textContent = total;

      if(cart.length === 0){
        cartList.innerHTML = `<p class="small">–ö–æ—à–Ω–∏—á–∫–∞—Ç–∞ –µ –ø—Ä–∞–∑–Ω–∞.</p>`;
        return;
      }

      cartList.innerHTML = cart.map(c => {
        const p = findProduct(c.id);
        if(!p) return "";
        return `
          <div class="item">
            <img class="thumb" src="${p.img}" alt="${p.name}">
            <div class="itxt">
              <b>${p.name}</b>
              <div class="small">${p.price} –¥–µ–Ω. √ó ${c.qty} = <b>${p.price*c.qty}</b> –¥–µ–Ω.</div>
              <div class="qty" style="margin-top:8px;">
                <button onclick="setQty('${c.id}', ${c.qty-1})">‚àí</button>
                <span style="min-width:22px; text-align:center;">${c.qty}</span>
                <button onclick="setQty('${c.id}', ${c.qty+1})">+</button>
                <button class="btn btn-danger" style="margin-left:auto; padding:8px 10px; border-radius:10px;"
                        onclick="setQty('${c.id}', 0)">–û—Ç—Å—Ç—Ä–∞–Ω–∏</button>
              </div>
            </div>
          </div>
        `;
      }).join("");
    }

    // Expose functions to inline onclick
    window.addToCart = addToCart;
    window.setQty = setQty;

    // Buttons
    document.getElementById("openCartBtn").addEventListener("click", openCart);
    overlay.addEventListener("click", closeCart);
    document.getElementById("clearCartBtn").addEventListener("click", clearCart);

    // Checkout placeholder (–ß–µ–∫–æ—Ä 2 —ú–µ –≥–æ –ø—Ä–∞–≤–∏–º–µ —Å–ª–µ–¥–Ω–æ)
    document.getElementById("goCheckoutBtn").addEventListener("click", () => {
      alert("–°–ª–µ–¥–Ω–æ –ø—Ä–∞–≤–∏–º–µ Checkout —Ñ–æ—Ä–º–∞ ‚úÖ (–ß–µ–∫–æ—Ä 2).");
    });

    // Init
    renderProducts();
    renderCartUI();
  </script>
</body>
</html> 
